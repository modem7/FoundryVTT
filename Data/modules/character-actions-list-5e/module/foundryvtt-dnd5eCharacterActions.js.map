{"version":3,"file":"foundryvtt-dnd5eCharacterActions.js","sources":["../../src/module/constants.ts","../../src/module/helpers.ts","../../src/module/settings.ts","../../src/module/getActorActionsData.ts","../../src/module/handleFavoriteControls.ts","../../src/module/foundryvtt-dnd5eCharacterActions.ts"],"sourcesContent":["export const MODULE_ID = 'character-actions-list-5e';\nexport const MODULE_ABBREV = 'CAL5E';\n\nexport enum MySettings {\n  includeConsumables = 'include-consumables',\n  includeOneMinuteSpells = 'include-one-minute-spells',\n  includeSpellsWithEffects = 'include-spells-with-effects',\n  injectCharacters = 'inject-characters',\n  injectNPCs = 'inject-npcs',\n  injectVehicles = 'inject-vehicles',\n  limitActionsToCantrips = 'limit-actions-to-cantrips',\n}\n\nexport enum MyFlags {\n  filterOverride = 'filter-override',\n}\n\nexport const TEMPLATES = {\n  actionList: `modules/${MODULE_ID}/templates/actor-actions-list.hbs`,\n};\n","import { MODULE_ID, MyFlags, MySettings } from './constants';\n\nexport function log(force: boolean, ...args) {\n  //@ts-ignore\n  const shouldLog = force || game.modules.get('_dev-mode')?.api?.getPackageDebugValue(MODULE_ID);\n\n  if (shouldLog) {\n    console.log(MODULE_ID, '|', ...args);\n  }\n}\n\nexport function getActivationType(activationType?: DND5e.AbilityActivationType) {\n  switch (activationType) {\n    case 'action':\n    case 'bonus':\n    case 'crew':\n    case 'lair':\n    case 'legendary':\n    case 'reaction':\n      return activationType;\n\n    default:\n      return 'other';\n  }\n}\n\nexport function isActiveItem(activationType?: string) {\n  if (!activationType) {\n    return false;\n  }\n  if (['minute', 'hour', 'day', 'none'].includes(activationType)) {\n    return false;\n  }\n  return true;\n}\n\nexport function isItemInActionList(item: Item5e) {\n  // log(false, 'filtering item', {\n  //   item,\n  // });\n\n  // check our override\n  const override = item.getFlag(MODULE_ID, MyFlags.filterOverride) as boolean | undefined;\n\n  if (override !== undefined) {\n    return override;\n  }\n\n  // check the old flags\n  //@ts-ignore\n  const isFavourite = item.flags?.favtab?.isFavourite; // favourite items tab\n  //@ts-ignore\n  const isFavorite = item.flags?.favtab?.isFavorite; // tidy 5e sheet\n\n  if (isFavourite || isFavorite) {\n    return true;\n  }\n\n  // perform normal filtering logic\n  switch (item.type) {\n    case 'weapon': {\n      return item.system.equipped;\n    }\n    case 'equipment': {\n      return item.system.equipped && isActiveItem(item.system.activation?.type);\n    }\n    case 'consumable': {\n      return (\n        !!getGame().settings.get(MODULE_ID, MySettings.includeConsumables) && isActiveItem(item.system.activation?.type)\n      );\n    }\n    case 'spell': {\n      const limitToCantrips = getGame().settings.get(MODULE_ID, MySettings.limitActionsToCantrips);\n\n      // only exclude spells which need to be prepared but aren't\n      const notPrepared = item.system.preparation?.mode === 'prepared' && !item.system.preparation?.prepared;\n\n      const isCantrip = item.system.level === 0;\n\n      if (!isCantrip && (limitToCantrips || notPrepared)) {\n        return false;\n      }\n\n      const isReaction = item.system.activation?.type === 'reaction';\n      const isBonusAction = item.system.activation?.type === 'bonus';\n\n      //ASSUMPTION: If the spell causes damage, it will have damageParts\n      const isDamageDealer = item.system.damage?.parts?.length > 0;\n\n      let shouldInclude = isReaction || isBonusAction || isDamageDealer;\n\n      if (getGame().settings.get(MODULE_ID, MySettings.includeOneMinuteSpells)) {\n        const isOneMinuter = item.system?.duration?.units === 'minute' && item.system?.duration?.value === 1;\n        const isOneRounder = item.system?.duration?.units === 'round' && item.system?.duration?.value === 1;\n\n        shouldInclude = shouldInclude || isOneMinuter || isOneRounder;\n      }\n\n      if (getGame().settings.get(MODULE_ID, MySettings.includeSpellsWithEffects)) {\n        const hasEffects = !!item.effects.size;\n        shouldInclude = shouldInclude || hasEffects;\n      }\n\n      return shouldInclude;\n    }\n    case 'feat': {\n      return !!item.system.activation?.type;\n    }\n    default: {\n      return false;\n    }\n  }\n}\n\nexport function getGame(): Game {\n  if (!(game instanceof Game)) {\n    throw new Error('game is not initialized yet!');\n  }\n  return game;\n}\n","import { MySettings, MODULE_ID, MODULE_ABBREV } from './constants';\nimport { getGame } from './helpers';\n\nexport const registerSettings = function () {\n  // Register any custom module settings here\n  getGame().settings.register(MODULE_ID, MySettings.limitActionsToCantrips, {\n    name: `${MODULE_ABBREV}.settings.limitActionsToCantrips.Label`,\n    default: false,\n    type: Boolean,\n    scope: 'client',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.limitActionsToCantrips.Hint`,\n  });\n\n  getGame().settings.register(MODULE_ID, MySettings.includeOneMinuteSpells, {\n    name: `${MODULE_ABBREV}.settings.includeOneMinuteSpells.Label`,\n    default: true,\n    type: Boolean,\n    scope: 'client',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.includeOneMinuteSpells.Hint`,\n  });\n\n  getGame().settings.register(MODULE_ID, MySettings.includeSpellsWithEffects, {\n    name: `${MODULE_ABBREV}.settings.includeSpellsWithEffects.Label`,\n    default: true,\n    type: Boolean,\n    scope: 'client',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.includeSpellsWithEffects.Hint`,\n  });\n\n  getGame().settings.register(MODULE_ID, MySettings.includeConsumables, {\n    name: `${MODULE_ABBREV}.settings.includeConsumables.Label`,\n    default: true,\n    type: Boolean,\n    scope: 'client',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.includeConsumables.Hint`,\n  });\n\n  getGame().settings.register(MODULE_ID, MySettings.injectCharacters, {\n    name: `${MODULE_ABBREV}.settings.injectCharacters.Label`,\n    default: true,\n    type: Boolean,\n    scope: 'client',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.injectCharacters.Hint`,\n  });\n\n  getGame().settings.register(MODULE_ID, MySettings.injectNPCs, {\n    name: `${MODULE_ABBREV}.settings.injectNPCs.Label`,\n    default: true,\n    type: Boolean,\n    scope: 'world',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.injectNPCs.Hint`,\n  });\n\n  getGame().settings.register(MODULE_ID, MySettings.injectVehicles, {\n    name: `${MODULE_ABBREV}.settings.injectVehicles.Label`,\n    default: true,\n    type: Boolean,\n    scope: 'world',\n    config: true,\n    hint: `${MODULE_ABBREV}.settings.injectVehicles.Hint`,\n  });\n};\n","import { getActivationType, getGame, isItemInActionList, log } from './helpers';\n\nenum ItemTypeSortValues {\n  weapon = 1,\n  equipment = 2,\n  feat = 3,\n  spell = 4,\n  consumable = 5,\n  tool = 6,\n  backpack = 7,\n  class = 8,\n  loot = 9,\n}\n\nexport function getActorActionsData(actor: Actor5e) {\n  const filteredItems = actor.items\n    .filter(isItemInActionList)\n    .sort((a, b) => {\n      if (a.type !== b.type) {\n        return ItemTypeSortValues[a.type] - ItemTypeSortValues[b.type];\n      }\n\n      if (a.type === 'spell' && b.type === 'spell') {\n        return a.system.level - b.system.level;\n      }\n\n      return (a.sort || 0) - (b.sort || 0);\n    })\n    .map((item) => {\n      if (item.labels) {\n        //@ts-expect-error\n        item.labels.type = getGame().i18n.localize(`DND5E.ItemType${item.type.titleCase()}`);\n      }\n\n      // removes any in-formula flavor text from the formula in the label\n      //@ts-expect-error\n      if (item.labels?.derivedDamage?.length) {\n        //@ts-expect-error\n        item.labels.derivedDamage = item.labels.derivedDamage.map(({ formula, ...rest }) => ({\n          formula: formula?.replace(/\\[.+?\\]/, '') || '0',\n          ...rest,\n        }));\n      }\n\n      return item;\n    });\n\n  const actionsData: Record<\n    'action' | 'bonus' | 'crew' | 'lair' | 'legendary' | 'reaction' | 'other',\n    Set<Item5e>\n  > = filteredItems.reduce(\n    (acc, item: Item5e) => {\n      try {\n        log(false, 'digesting item', {\n          item,\n        });\n        if (['backpack', 'tool'].includes(item.type)) {\n          return acc;\n        }\n\n        //@ts-ignore\n        const activationType = getActivationType(item.system.activation?.type);\n\n        acc[activationType].add(item);\n\n        return acc;\n      } catch (e) {\n        log(true, 'error trying to digest item', item.name, e);\n        return acc;\n      }\n    },\n    {\n      action: new Set<Item5e>(),\n      bonus: new Set<Item5e>(),\n      crew: new Set<Item5e>(),\n      lair: new Set<Item5e>(),\n      legendary: new Set<Item5e>(),\n      reaction: new Set<Item5e>(),\n      other: new Set<Item5e>(),\n    },\n  );\n\n  return actionsData;\n}\n","import { MODULE_ABBREV, MODULE_ID, MyFlags } from './constants';\nimport { getGame, isItemInActionList, log } from './helpers';\n\nexport function addFavoriteControls(\n  app: FormApplication & {\n    object: Actor5e;\n  },\n  html: JQuery,\n) {\n  function createFavButton(filterOverride: boolean) {\n    return `<a class=\"item-control item-action-filter-override ${filterOverride ? 'active' : ''}\" title=\"${\n      filterOverride\n        ? getGame().i18n.localize(`${MODULE_ABBREV}.button.setOverrideFalse`)\n        : getGame().i18n.localize(`${MODULE_ABBREV}.button.setOverrideTrue`)\n    }\">\n      <i class=\"fas fa-fist-raised\">\n        <i class=\"fas fa-slash\"></i>\n        <i class=\"fas fa-plus\"></i>\n      </i>\n      <span class=\"control-label\">${\n        filterOverride\n          ? getGame().i18n.localize(`${MODULE_ABBREV}.button.setOverrideFalse`)\n          : getGame().i18n.localize(`${MODULE_ABBREV}.button.setOverrideTrue`)\n      }</span>\n    </a>`;\n  }\n\n  // add button to toggle favourite of the item in their native tab\n  if (app.options.editable) {\n    // Handle Click on our action\n    $(html).on('click', 'a.item-action-filter-override', (e) => {\n      try {\n        const closestItemLi = $(e.target).parents('[data-item-id]')[0]; // BRITTLE\n        const itemId = closestItemLi.dataset.itemId;\n        const relevantItem = itemId && app.object.items.get(itemId);\n\n        if (!relevantItem) {\n          return;\n        }\n\n        const currentFilter = isItemInActionList(relevantItem);\n\n        // set the flag to be the opposite of what it is now\n        relevantItem.setFlag(MODULE_ID, MyFlags.filterOverride, !currentFilter);\n\n        log(false, 'a.item-action-filter-override click registered', {\n          closestItemLi,\n          itemId,\n          relevantItem,\n          currentFilter,\n        });\n      } catch (e) {\n        log(true, 'Error trying to set flag on item', e);\n      }\n    });\n\n    // Add button to all item rows\n    html.find('[data-item-id]').each((_index, element: HTMLElement) => {\n      const itemId = element.dataset.itemId;\n      const relevantItem = itemId && app.object.items.get(itemId);\n\n      if (!relevantItem) {\n        return;\n      }\n\n      const currentFilter = isItemInActionList(relevantItem);\n\n      // log(false, { itemId, currentFilter });\n\n      $(element).find('.item-controls').append(createFavButton(currentFilter));\n    });\n  }\n}\n","import { registerSettings } from './settings';\nimport { MODULE_ABBREV, MODULE_ID, MySettings, TEMPLATES } from './constants';\nimport { getGame, isItemInActionList, log } from './helpers';\nimport { getActorActionsData } from './getActorActionsData';\nimport { addFavoriteControls } from './handleFavoriteControls';\n\nHandlebars.registerHelper(`${MODULE_ABBREV}-isEmpty`, (input: Object | Array<any> | Set<any>) => {\n  if (input instanceof Array) {\n    return input.length < 1;\n  }\n  if (input instanceof Set) {\n    return input.size < 1;\n  }\n  return isObjectEmpty(input);\n});\n\nHandlebars.registerHelper(`${MODULE_ABBREV}-isItemInActionList`, isItemInActionList);\n\n/**\n * Add the Actions Tab to Sheet HTML. Returns early if the character-actions-dnd5e element already exists\n */\nasync function addActionsTab(\n  app: ActorSheet5e,\n  html,\n  data: ReturnType<ActorSheet5e['getData']> extends Promise<infer T> ? T : ReturnType<ActorSheet5e['getData']>,\n) {\n  if (data instanceof Promise) {\n    log(true, 'data was unexpectedly a Promise, you might be using an unsupported sheet');\n    return;\n  }\n\n  const existingActionsList = $(html).find('.character-actions-dnd5e');\n\n  // check if what is rendering this is an Application and if our Actions List exists within it already\n  if ((!!app.appId && !!existingActionsList.length) || app.options.blockActionsTab) {\n    return;\n  }\n\n  // Update the nav menu\n  const actionsTabButton = $(\n    '<a class=\"item\" data-tab=\"actions\">' + getGame().i18n.localize(`DND5E.ActionPl`) + '</a>',\n  );\n  const tabs = html.find('.tabs[data-group=\"primary\"]');\n  tabs.prepend(actionsTabButton);\n\n  // Create the tab\n  const sheetBody = html.find('.sheet-body');\n  const actionsTab = $(`<div class=\"tab actions flexcol\" data-group=\"primary\" data-tab=\"actions\"></div>`);\n  sheetBody.prepend(actionsTab);\n\n  // add the list to the tab\n  const actionsTabHtml = $(await renderActionsList(app.actor));\n  actionsTab.append(actionsTabHtml);\n\n  // @ts-ignore\n  actionsTabHtml.find('.item .item-name.rollable h4').click((event) => app._onItemSummary(event));\n\n  // owner only listeners\n  if (data.owner) {\n    // @ts-ignore\n    actionsTabHtml.find('.item .item-image').click((event) => app._onItemUse(event));\n    // @ts-ignore\n    actionsTabHtml.find('.item .item-recharge').click((event) => app._onItemRecharge(event));\n  } else {\n    actionsTabHtml.find('.rollable').each((i, el) => el.classList.remove('rollable'));\n  }\n}\n\nconst damageTypeIconMap = {\n  acid: '<i class=\"fas fa-hand-holding-water\"></i>',\n  bludgeoning: '<i class=\"fas fa-gavel\"></i>',\n  cold: '<i class=\"fas fa-snowflake\"></i>',\n  fire: '<i class=\"fas fa-fire-alt\"></i>',\n  force: '<i class=\"fas fa-hat-wizard\"></i>',\n  lightning: '<i class=\"fas fa-bolt\"></i>',\n  necrotic: '<i class=\"fas fa-skull\"></i>',\n  piercing: '<i class=\"fas fa-thumbtack\"></i>',\n  poison: '<i class=\"fas fa-skull-crossbones\"></i>',\n  psychic: '<i class=\"fas fa-brain\"></i>',\n  radiant: '<i class=\"fas fa-sun\"></i>',\n  slashing: '<i class=\"fas fa-cut\"></i>',\n  thunder: '<i class=\"fas fa-wind\"></i>',\n  healing: '<i class=\"fas fa-heart\"></i>',\n  temphp: '<i class=\"fas fa-shield-alt\"></i>',\n};\n\n/**\n * Renders the html of the actions list for the provided actor data\n */\nasync function renderActionsList(\n  actorData: Actor5e,\n  options?: {\n    rollIcon?: string;\n  },\n) {\n  const actionData = getActorActionsData(actorData);\n\n  log(false, 'renderActionsList', {\n    actorData,\n    data: actionData,\n  });\n\n  return renderTemplate(`modules/${MODULE_ID}/templates/actor-actions-list.hbs`, {\n    actionData,\n    abilities: getGame().dnd5e.config.abilityAbbreviations,\n    activationTypes: {\n      ...getGame().dnd5e.config.abilityActivationTypes,\n      other: getGame().i18n.localize(`DND5E.ActionOther`),\n    },\n    damageTypes: { ...getGame().dnd5e.config.damageTypes, ...getGame().dnd5e.config.healingTypes },\n    damageTypeIconMap,\n    rollIcon: options?.rollIcon,\n    isOwner: actorData.isOwner,\n  });\n}\n\n/* ------------------------------------ */\n/* Initialize module\t\t\t\t\t*/\n/* ------------------------------------ */\nHooks.once('init', async function () {\n  log(true, `Initializing ${MODULE_ID}`);\n\n  // Register custom module settings\n  registerSettings();\n\n  // Preload Handlebars templates\n  await loadTemplates(Object.values(flattenObject(TEMPLATES)));\n\n  const characterActionsModuleData = getGame().modules.get(MODULE_ID);\n\n  if (characterActionsModuleData) {\n    characterActionsModuleData.api = {\n      getActorActionsData,\n      isItemInActionList,\n      renderActionsList,\n    };\n  }\n\n  globalThis[MODULE_ABBREV] = {\n    renderActionsList: async function (...args) {\n      log(false, {\n        api: characterActionsModuleData?.api,\n      });\n\n      console.warn(\n        MODULE_ID,\n        '|',\n        'accessing the module api on globalThis is deprecated and will be removed in a future update, check if there is an update to your sheet module',\n      );\n      return characterActionsModuleData?.api?.renderActionsList(...args);\n    },\n    isItemInActionList: function (...args) {\n      console.warn(\n        MODULE_ID,\n        '|',\n        'accessing the module api on globalThis is deprecated and will be removed in a future update, check if there is an update to your sheet module',\n      );\n      return characterActionsModuleData?.api?.isItemInActionList(...args);\n    },\n  };\n\n  Hooks.call(`CharacterActions5eReady`, characterActionsModuleData?.api);\n});\n\n// default sheet injection if this hasn't yet been injected\nHooks.on('renderActorSheet5e', async (app, html, data) => {\n  // short circut if the user has overwritten these settings\n  switch (app.actor.type) {\n    case 'npc':\n      const injectNPCSheet = getGame().settings.get(MODULE_ID, MySettings.injectNPCs) as boolean;\n      if (!injectNPCSheet) return;\n    case 'vehicle':\n      const injectVehicleSheet = getGame().settings.get(MODULE_ID, MySettings.injectVehicles) as boolean;\n      if (!injectVehicleSheet) return;\n    case 'character':\n      const injectCharacterSheet = getGame().settings.get(MODULE_ID, MySettings.injectCharacters) as boolean;\n      if (!injectCharacterSheet) return;\n  }\n\n  log(false, 'default sheet open hook firing', {\n    app,\n    html,\n    data,\n  });\n\n  const actionsList = $(html).find('.character-actions-dnd5e');\n\n  log(false, 'actionsListExists', { actionsListExists: actionsList.length });\n\n  if (!actionsList.length) {\n    await addActionsTab(app, html, data);\n  }\n\n  addFavoriteControls(app, html);\n});\n\nHooks.once('devModeReady', ({ registerPackageDebugFlag }) => {\n  registerPackageDebugFlag(MODULE_ID);\n});\n"],"names":[],"mappings":"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"}
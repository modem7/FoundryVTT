{"version":3,"file":"hey-wait.js","mappings":"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BAAM;;AAErJ;AACA,mBAAmB,aAAa;AAChC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;AACD,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,0DAA0D,OAAO;AACjE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,SAAS;AACtB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0CAA0C,SAAS;AACnD;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA,gBAAgB,YAAY;AAC5B;;AAEA;AACA,4DAA4D;AAC5D,gEAAgE;AAChE,oEAAoE;AACpE,wEAAwE;AACxE;AACA,2DAA2D,SAAS;AACpE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,WAAW,SAAS;AACpB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,4DAA4D,YAAY;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,cAAc;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2CAA2C;AAC1D,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,uBAAuB;AACvB,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0CAA0C;AACpE;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,oBAAoB;AACnC,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,cAAc,aAAa;AAC3B,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,aAAa;AACzB;AACA;AACA;AACA;AACA,iCAAiC,2BAA2B,IAAI,eAAe;AAC/E;AACA;AACA;AACA,oCAAoC,YAAY,IAAI,qCAAqC;AACzF;AACA;AACA,iCAAiC,oCAAoC;AACrE;AACA;AACA,2BAA2B,uCAAuC;AAClE;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,mBAAmB,2EAA2E,4CAA4C;AACzJ,eAAe,SAAS;AACxB,eAAe,aAAa;AAC5B,eAAe,QAAQ,2EAA2E;AAClG;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2CAA2C;AAC1D;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,iCAAiC;AAChD,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,iCAAiC;AAChD,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,mBAAmB,2GAA2G;AAC7I,eAAe,mBAAmB,mGAAmG;AACrI,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,mBAAmB;AAClC,eAAe,kBAAkB;AACjC,eAAe,SAAS;AACxB,eAAe,QAAQ;AACvB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,MAAM,IAAI,0DAA0D;AAC1H,eAAe,oBAAoB;AACnC,eAAe,iCAAiC;AAChD,eAAe,QAAQ;AACvB;AACA,eAAe,QAAQ;AACvB,eAAe,mBAAmB;AAClC,eAAe,kBAAkB;AACjC,eAAe,SAAS;AACxB,eAAe,QAAQ;AACvB,eAAe,SAAS;AACxB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA,oDAAoD,MAAM,IAAI,mEAAmE;AACjI,eAAe,oBAAoB;AACnC,eAAe,iCAAiC;AAChD,eAAe,QAAQ;AACvB;AACA,eAAe,QAAQ;AACvB,eAAe,mBAAmB;AAClC,eAAe,kBAAkB;AACjC,eAAe,SAAS;AACxB,eAAe,QAAQ;AACvB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA,eAAe,oBAAoB;AACnC,eAAe,mBAAmB;AAClC;AACA;AACA;AACA,wBAAwB,yBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;;AAE4B;AAC5B;;;;;;;UC11CA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC;;;;;WCPD;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA;;AACA;;AAEA;AACA;AACA;;AACA,IAAIuH,SAAJ;AAEA;AACA;AACA;;AACA,IAAIC,qBAAJ;AAEA;AACA;AACA;;AACA,IAAIjD,iBAAJ;AAEA;AACA;AACA;;AACA,IAAIjC,kBAAJ;AAEA;AACA;AACA;;AACA,IAAI4F,WAAJ;AAEA;AACA;AACA;;AACA,IAAI1D,gBAAJ;AAEA;AACA;AACA;;AACA,IAAInC,cAAJ;AAEA;AACA;AACA;;AACA,IAAI+E,eAAJ;AAEA;AACA;AACA;;AACA,IAAIjF,WAAJ;AAEA;AACA;AACA;;AACA,IAAIgG,sBAAJ;AAEA;AACA;AACA;;AACA,IAAIlH,eAAJ;AAEA;AACA;AACA;;AACA,IAAIoG,mBAAJ;AAEA;AACA;AACA;;AACA,IAAIjF,YAAJ;AAEA;AACA;AACA;;AACA,IAAIlB,QAAJ;AAEA;AACA;AACA;;AACA,IAAIkH,UAAJ,EAEA;;AACA,MAAM;AACJC,EAAAA,KADI;AAEJC,EAAAA,MAFI;AAGJC,EAAAA;AAHI,IAIFzF,qBAJJ;AAMA;AACA;AACA;AACA;AAC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","sources":["webpack://hey-wait/./src/module/Animator.js","webpack://hey-wait/./src/module/Collision.js","webpack://hey-wait/./src/module/Constants.js","webpack://hey-wait/./src/module/ControlsGenerator.js","webpack://hey-wait/./src/module/EntityFinder.js","webpack://hey-wait/./src/module/GameChanger.js","webpack://hey-wait/./src/module/MacroOperations.js","webpack://hey-wait/./src/module/ReactionCoordinator.js","webpack://hey-wait/./src/module/SocketController.js","webpack://hey-wait/./src/module/TileAuditor.js","webpack://hey-wait/./src/module/TokenAnimationWatcher.js","webpack://hey-wait/./src/module/TokenCalculator.js","webpack://hey-wait/./src/module/TokenUpdateCoordinator.js","webpack://hey-wait/./src/module/UserOperations.js","webpack://hey-wait/./src/module/hooks/TokenHooks.js","webpack://hey-wait/./src/module/settings.js","webpack://hey-wait/./src/module/triggering/PostTriggerActions.js","webpack://hey-wait/./src/module/triggering/TriggeringHandler.js","webpack://hey-wait/./node_modules/pixi-ease/dist/ease.es.js","webpack://hey-wait/webpack/bootstrap","webpack://hey-wait/webpack/runtime/define property getters","webpack://hey-wait/webpack/runtime/global","webpack://hey-wait/webpack/runtime/hasOwnProperty shorthand","webpack://hey-wait/webpack/runtime/make namespace object","webpack://hey-wait/./src/hey-wait.js"],"sourcesContent":["/* global PIXI */\n\n/**\n * A class to animate the Hey, Wait! reactions. This currently includes showing\n * a \"?\" or \"!\" on top of the specified X and Y coordinates.\n */\nexport default class Animator {\n  constructor(layer, ease) {\n    /**\n     * The injected Layer instance dependency.\n     */\n    this.layer = layer;\n\n    /**\n     * The injected PIXI Ease dependency.\n     */\n    this.ease = ease;\n  }\n\n  /**\n   * Enum for the animation types.\n   *\n   * @return {Object}\n   */\n  static get animationTypes() {\n    return {\n      TYPE_NONE: 0,\n      TYPE_INFO: 1,\n      TYPE_QUESTION: 2,\n      TYPE_EXCLAMATION: 3,\n    };\n  }\n\n  /**\n   * Animate the selected Hey, Wait! reaction type to the user.\n   *\n   * @param {Animator.animationTypes} type\n   *   The specified type to animate.\n   * @param {number} x\n   *   The X coordinate where we should render the sprite.\n   * @param {number} y\n   *   The Y coordinate where we should render the sprite.\n   * @param {number} gridSize\n   *   The size of a grid space.\n   */\n  animate(type, x, y, gridSize) {\n    if (type === Animator.animationTypes.TYPE_NONE) {\n      return;\n    }\n\n    const sprite = this._getSprite(type, gridSize);\n    sprite.alpha = 0;\n\n    // Ensure we're anchoring to the center of the token.\n    sprite.anchor.set(0.5);\n    sprite.position.x = x;\n    sprite.position.y = y;\n    sprite.name = Math.random().toString(36).substring(16);\n\n    const child = this.layer.addChild(sprite);\n\n    const anim1 = this.ease.add(\n      child,\n      { alpha: 100, x, y: y - (gridSize * 0.25) },\n      { duration: 150 },\n    );\n\n    anim1.once('complete', () => {\n      const anim2 = this.ease.add(\n        child,\n        { x, y: y - (gridSize * 1.25) },\n        { duration: 100 },\n      );\n\n      anim2.once('complete', () => {\n        const anim3 = this.ease.add(\n          child,\n          { x, y: y - (gridSize * 0.85) },\n          { duration: 100 },\n        );\n\n        anim3.once('complete', () => {\n          const anim4 = this.ease.add(\n            child,\n            { x, y: y - (gridSize * 0.95) },\n            { duration: 45 },\n          );\n\n          anim4.once('complete', () => {\n            const anim5 = this.ease.add(\n              child,\n              { x, y: y - (gridSize * 0.85) },\n              { duration: 45 },\n            );\n\n            anim5.once('complete', () => {\n              const anim6 = this.ease.add(\n                child,\n                { alpha: 0 },\n                { duration: 2500 },\n              );\n\n              anim6.once('complete', () => {\n                this.layer.removeChild(child);\n              });\n            });\n          });\n        });\n      });\n    });\n  }\n\n  /**\n   * Get the Pixi Sprite to be rendered.\n   *\n   * @param {Animator.animationTypes} type\n   *   The type of animation we should be creating.\n   * @param {number} gridSize\n   *   The size of the Canvas grid.\n   *\n   * @return {PIXI.Text}\n   *   The sprite.\n   *\n   * @private\n   */\n  _getSprite(type, gridSize) {\n    const fontSize = Math.round(gridSize * 0.6);\n\n    return new PIXI.Text(\n      this._getTextFromType(type),\n      new PIXI.TextStyle({\n        fontSize,\n        dropShadow: true,\n        dropShadowDistance: 4,\n        fill: '#feffff',\n        fontFamily: 'Signika',\n        fontWeight: 'bolder',\n        strokeThickness: 4,\n      }),\n    );\n  }\n\n  /**\n   * Get the text to render from the provided Animator type.\n   *\n   * @param {Animator.T}type\n   * @return {string}\n   * @private\n   */\n  _getTextFromType(type) {\n    switch (type) {\n      case Animator.animationTypes.TYPE_QUESTION:\n        return '?';\n      case Animator.animationTypes.TYPE_EXCLAMATION:\n        return '!';\n      case Animator.animationTypes.TYPE_INFO:\n        return 'ⓘ';\n      default:\n        throw new Error(`Cannot find text for Animator type ${type}`);\n    }\n  }\n}\n","/* global Ray */\n\n/**\n * A class to determine collision between relevant Entitys.\n */\nexport default class Collision {\n  /**\n   * Collision constructor.\n   *\n   * @param {number} gridSize\n   *   The grid size of the canvas for our calculations.\n   */\n  constructor(gridSize) {\n    this.gridSize = gridSize;\n  }\n\n  /**\n   * Check if a Tile and a Token collide.\n   *\n   * @param {Tile} tile\n   *   The Tile to check.\n   * @param {Token} token\n   *   The Token to check.\n   * @param {x,y} initTokenPos\n   *   The initial position of the Token before it was updated. X and Y values.\n   *\n   * @return {boolean}\n   *   If the Tile and Token collide.\n   */\n  checkTileTokenCollision(tile, token, initTokenPos) {\n    // 1. Get all the tile's vertices. X and Y are position at top-left corner\n    // of tile.\n    const tileX1 = tile.data.x;\n    const tileY1 = tile.data.y;\n    const tileX2 = tile.data.x + tile.data.width;\n    const tileY2 = tile.data.y + tile.data.height;\n\n    const tokenCanvasWidth = token.data.width * this.gridSize;\n    const tokenCanvasHeight = token.data.height * this.gridSize;\n\n    const tokenX1 = initTokenPos.x + (tokenCanvasWidth / 2);\n    const tokenY1 = initTokenPos.y + (tokenCanvasHeight / 2);\n    const tokenX2 = token.data.x + (tokenCanvasWidth / 2);\n    const tokenY2 = token.data.y + (tokenCanvasHeight / 2);\n\n    // 2. Create a new Ray for the token, from its starting position to its\n    // destination.\n    const tokenRay = new Ray(\n      {\n        x: tokenX1,\n        y: tokenY1,\n      },\n      {\n        x: tokenX2,\n        y: tokenY2,\n      },\n    );\n\n    // 3. Create four intersection checks, one for each line making up the\n    // tile rectangle. If any of these pass, that means it has intersected at\n    // some point.\n    return Boolean(tokenRay.intersectSegment([\n      tileX1,\n      tileY1,\n      tileX2,\n      tileY1,\n    ]))\n      || Boolean(tokenRay.intersectSegment([\n        tileX2,\n        tileY1,\n        tileX2,\n        tileY2,\n      ]))\n      || Boolean(tokenRay.intersectSegment([\n        tileX2,\n        tileY2,\n        tileX1,\n        tileY2,\n      ]))\n      || Boolean(tokenRay.intersectSegment([\n        tileX1,\n        tileY2,\n        tileX1,\n        tileY1,\n      ]));\n  }\n}\n","import Animator from './Animator';\n\n/**\n * A class storing our module's constants.\n */\nexport default class Constants {\n  /**\n   * The name and identifier of the module.\n   *\n   * @return {string}\n   */\n  static get MODULE_NAME() {\n    return 'hey-wait';\n  }\n\n  /**\n   * The identifier of the tool in the controls toolbar.\n   *\n   * @return {string}\n   */\n  static get TOOLNAME() {\n    return 'heyWaitTile';\n  }\n\n  /**\n   * The possible token disposition choices for triggering Hey, Wait! tiles.\n   *\n   * @return {object}\n   */\n  static get DISPOSITION_CHOICES() {\n    return {\n      FRIENDLY: 1,\n      FRIENDLY_NETURAL: 2,\n      FRIENDLY_NEUTRAL_HOSTILE: 3,\n    };\n  }\n\n  /**\n   * The default animation type when no other is available.\n   *\n   * @return {number}\n   */\n  static get DEFAULT_ANIM_TYPE() {\n    return Animator.animationTypes.TYPE_NONE;\n  }\n\n  /**\n   * The filepath to the HUD template.\n   *\n   * @return {string}\n   */\n  static get TEMPLATE_HUD_PATH() {\n    return '/modules/hey-wait/src/templates/hud.hbs';\n  }\n\n  /**\n   * The filepath for the \"Hey, Wait! Stop\" tile image.\n   *\n   * @return {string}\n   */\n  static get TILE_STOP_PATH() {\n    return 'modules/hey-wait/src/img/hey_wait_stop.jpg';\n  }\n\n  /**\n   * The width of the \"Hey, Wait! Stop\" tile.\n   *\n   * @return {number}\n   */\n  static get TILE_STOP_WIDTH() {\n    return 200;\n  }\n\n  /**\n   * The height of the \"Hey, Wait! Stop\" tile.\n   *\n   * @return {number}\n   */\n  static get TILE_STOP_HEIGHT() {\n    return 167;\n  }\n\n  /**\n   * The filepath for the \"Hey, Wait! Go\" tile image.\n   *\n   * @return {string}\n   */\n  static get TILE_GO_PATH() {\n    return 'modules/hey-wait/src/img/hey_wait_go.jpg';\n  }\n\n  /**\n   * The width of the \"Hey, Wait! Go\" tile.\n   *\n   * @return {number}\n   */\n  static get TILE_GO_WIDTH() {\n    return 222;\n  }\n\n  /**\n   * The height of the \"Hey, Wait! Go\" tile.\n   *\n   * @return {number}\n   */\n  static get TILE_GO_HEIGHT() {\n    return 160;\n  }\n\n  /**\n   * The filepath for the fallback tile image.\n   *\n   * @return {string}\n   */\n  static get TILE_FALLBACK_PATH() {\n    return 'icons/svg/hazard.svg';\n  }\n\n  /**\n   * How long our Canvas panning should last.\n   *\n   * @return {number}\n   */\n  static get CANVAS_PAN_DURATION() {\n    return 1000;\n  }\n}\n","/**\n * Facilitate the generation of the Controls for the toolbar.\n */\nimport Constants from './Constants';\n\n/**\n * Generate the control buttons / icons in the toolbar.\n */\nexport default class ControlsGenerator {\n  /**\n   * Generate the toolbar controls.\n   *\n   * @param {Object} controls\n   *   The game's controls object.\n   * @param {Boolean} isGm\n   *   If the current user is a GM.\n   */\n  generate(controls, isGm) {\n    if (!isGm) {\n      return;\n    }\n\n    const tileControl = controls.find((control) => control?.name === 'tiles');\n\n    if (!tileControl) {\n      return;\n    }\n\n    // Insert the Hey, Wait! tile after the browse control button.\n    let browseControlIndex;\n    tileControl.tools.forEach((tool, index) => {\n      if (tool.name === 'browse') {\n        browseControlIndex = index + 1;\n      }\n    });\n\n    if (!browseControlIndex) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Could not find the \"Browse Tile\" control. Not adding Hey, Wait! control',\n      );\n      return;\n    }\n\n    tileControl.tools.splice(browseControlIndex, 0, {\n      name: Constants.TOOLNAME,\n      title: 'HEYWAIT.CONTROLS.TOOLS.heyWaitTile',\n      icon: 'fas fa-hand-paper',\n    });\n  }\n}\n","/**\n * A class to find entities and their data in the Game based on sparse\n * information.\n */\nexport default class EntityFinder {\n  /**\n   * EntityFinder constructor.\n   *\n   * @param {Game} game\n   *   The injected Game dependency.\n   * @param {Canvas} canvas\n   *   The injected Canvas dependency.\n   */\n  constructor(game, canvas) {\n    this.game = game;\n    this.canvas = canvas;\n  }\n\n  /**\n   * Find the Scene by Scene ID.\n   *\n   * @param {string} sceneId\n   *   The ID of the Scene to find.\n   *\n   * @return {Scene}\n   */\n  findScene(sceneId) {\n    const scene = this.game.scenes.get(sceneId);\n\n    if (!scene) {\n      throw new Error(`Could not find a scene with ID ${sceneId}`);\n    }\n\n    return scene;\n  }\n\n  /**\n   * Find the TokenDocument by Token ID.\n   *\n   * @param {string} tokenId\n   *   The ID of the Token.\n   * @param {string} sceneId\n   *   The ID of the Scene.\n   *\n   * @return {TokenDocument}\n   */\n  findTokenDocument(tokenId, sceneId) {\n    const scene = this.findScene(sceneId);\n    const { tokens } = scene.data;\n\n    const tokenDocument = tokens.find((token) => token.id === tokenId);\n\n    if (!tokenDocument) {\n      throw new Error(\n        `Could not find Token document with ID ${tokenId} in Scene ${scene.data._id}`,\n      );\n    }\n\n    return tokenDocument;\n  }\n\n  /**\n   * Find the Tile by Tile ID.\n   *\n   * @param {string} tileId\n   *   The ID of the tile.\n   *\n   * @return {Tile}\n   */\n  findTile(tileId) {\n    const filtered = this.canvas.background.tiles.filter((tile) => tile.id === tileId);\n\n    if (!filtered.length) {\n      return false;\n    }\n\n    return filtered[0];\n  }\n}\n","import Constants from './Constants';\n\n/**\n * A class to \"change\" the game when a Hey, Wait! event has been triggered.\n */\nexport default class GameChanger {\n  constructor(game, canvas) {\n    this.game = game;\n    this.canvas = canvas;\n  }\n\n  /**\n   * Execute any changes to the game after a Hey, Wait! event has been triggered.\n   *\n   * @param {string} tileId\n   *   The relevant Tile ID that has been triggered.\n   * @param {x,y} location\n   *   The location where the triggering occurred.\n   *\n   * @param {string} sceneId\n   *   The scene ID where the triggering occurred.\n   *\n   * @return {Promise<void>}\n   */\n  async execute(tileId, location, sceneId) {\n    await this._changeScene(sceneId);\n\n    if (this.game.user.isGM) {\n      this._pause();\n      this._handleTileChange(tileId);\n    }\n  }\n\n  /**\n     * Animate the canvas moving over to the desired location.\n     *\n     * @param {x,y} location\n     *   A location designated by X and Y coords.\n     *\n     * @return {Promise}\n     */\n  async pan(location) {\n    const { x, y } = location;\n\n    return this.canvas.animatePan({\n      x,\n      y,\n      scale: Math.max(1, this.canvas.stage.scale.x),\n      duration: Constants.CANVAS_PAN_DURATION,\n    });\n  }\n\n  /**\n   * Handle the tile triggering adjustments such as updating flags and image.\n   *\n   * Can only be executed as the GM.\n   *\n   * @param {string} tileId\n   *   The relevant tile ID.\n   */\n  _handleTileChange(tileId) {\n    const tile = this.canvas.background.get(tileId);\n\n    if (!tile) {\n      throw new Error(`Could not find a tile with ID ${tileId}`);\n    }\n\n    const { document } = tile;\n\n    const update = {\n      flags: {\n        'hey-wait': {\n          triggered: true,\n        },\n      },\n      img: Constants.TILE_GO_PATH,\n    };\n\n    document.update(\n      update,\n    );\n  }\n\n  /**\n   * Change the current scene for the user.\n   *\n   * @param {string} sceneId\n   *   The scene ID to change to.\n   *\n   * @return {Promise<void>}\n   *\n   * @private\n   */\n  async _changeScene(sceneId) {\n    const scene = this.game.scenes.get(sceneId);\n\n    if (!scene) {\n      throw new Error(`Could not find a scene with ID ${sceneId}`);\n    }\n\n    await scene.view();\n  }\n\n  /**\n   * Pause the game.\n   *\n   * @private\n   */\n  _pause() {\n    this.game.togglePause(true, true);\n  }\n}\n","export default class MacroOperations {\n  /**\n   * MacroOperations constructor.\n   *\n   * @param {User} user\n   *   The injected User dependency. The current user.\n   * @param {BackgroundLayer} backgroundLayer\n   *   The injected BackgroundLayer dependency.\n   * @param {Map} macros\n   *   The injected game macros map dependency.\n   * @param {Notifications} notifications\n   *   The injected Notifications dependency.\n   */\n  constructor(user, backgroundLayer, macros, notifications) {\n    this.user = user;\n    this.backgroundLayer = backgroundLayer;\n    this.macros = macros;\n    this.notifications = notifications;\n  }\n\n  /**\n   * Handle the tile triggering macro execution, if one is set.\n   *\n   * Can only be executed as the GM.\n   *\n   * @param {string} tileId\n   *   The relevant tile ID.\n   * @param {TokenDocument} tokenDoc\n   *   The relevant TokenDocument that is the protagonist.\n   */\n  handleTileMacroFiring(tileId, tokenDoc) {\n    if (!this.user.isGM) {\n      return;\n    }\n\n    let tile;\n\n    for (const bgTile of this.backgroundLayer.tiles) {\n      if (bgTile.id === tileId) {\n        tile = bgTile;\n        break;\n      }\n    }\n\n    if (!tile) {\n      return;\n    }\n\n    const macroId = tile.data?.flags?.['hey-wait']?.macro;\n    if (!macroId || macroId === '0') {\n      return;\n    }\n\n    const macro = this.macros.get(macroId);\n    if (!macro) {\n      this.notifications.error(\n        'The macro triggered by the Hey, Wait! tile no longer exists.',\n      );\n      return;\n    }\n\n    macro.execute({\n      actor: tokenDoc.getActor(),\n      token: tokenDoc.object,\n    });\n  }\n}\n","/* eslint-disable no-loop-func */\n/* eslint-disable no-await-in-loop */\n/* global AudioHelper */\n\nimport Animator from './Animator';\nimport Constants from './Constants';\n\n/**\n * Coordinate processing and running any reactions within the module.\n */\nexport default class ReactionCoordinator {\n  /**\n   * ReactionCoordinator constructor.\n   *\n   * @param {TokenCalculator} tokenCalculator\n   *   The injected TokenCalculator dependency.\n   * @param {Animator} animator\n   *   The injected Animator dependency.\n   * @param {ClientSettings} settings\n   *   The injected ClientSettings dependency. Contains all current game\n   *   settings.\n   */\n  constructor(tokenCalculator, animator, settings) {\n    this.tokenCalculator = tokenCalculator;\n    this.animator = animator;\n    this.settings = settings;\n  }\n\n  /**\n   * Handle the reaction (animation and SFX) on the specified Token.\n   *\n   * @param {Scene} scene\n   *   The current Scene.\n   * @param {Token} token\n   *   The associated Token to animate the reaction on.\n   * @param {Animator.animationTypes} animType\n   *   The associated Token to animate the reaction on.\n   *\n   * @return {Promise}\n   */\n  handleTokenReaction(scene, token, animType) {\n    const coords = this.tokenCalculator.calculateCoordinates(\n      scene,\n      token.data,\n    );\n\n    this.animator.animate(\n      animType,\n      coords.x,\n      coords.y,\n      scene.data.grid,\n    );\n\n    this._handleSfx(animType);\n  }\n\n  /**\n   * Handle the playing of any sound effects, if applicable to the animation.\n   *\n   * @param {Animator.animationTypes} animType\n   *   One of the animation types, which corresponds to the SFX ID number.\n   *\n   * @private\n   */\n  _handleSfx(animType) {\n    if (\n      animType === Animator.animationTypes.TYPE_NONE\n      || this._sfxDisabled()\n    ) {\n      return;\n    }\n\n    const path = `modules/hey-wait/sounds/reaction${animType}.mp3`;\n    AudioHelper.play({\n      src: path,\n      autoplay: true,\n      volume: 0.5,\n    }, false);\n  }\n\n  /**\n   * Get if the sound effects for animations are disabled.\n   *\n   * @return {boolean}\n   *   If the sound effects for animations are disabled.\n   *\n   * @private\n   */\n  _sfxDisabled() {\n    return Boolean(this.settings.get(\n      Constants.MODULE_NAME,\n      'disable-sfx',\n    ));\n  }\n}\n","/* eslint-disable no-console */\n\n/**\n * A controller for handling socket related operations for our module.\n */\nexport default class SocketController {\n  /**\n   * SocketController constructor.\n   *\n   * @param {Socket} socket\n   *   The current Socket instance.\n   * @param {User} user\n   *   The current User instance.\n   * @param {GameChanger} gameChanger\n   *   The current GameChanger instance.\n   * @param {EntityFinder} entityFinder\n   *   The current EntityFinder instance.\n   * @param {UserOperations} userOperations\n   *   The current UserOperations instance.\n   * @param {TriggerActions} triggerActions\n   *   The current TriggerActions instance.\n   * @param {PostTriggerActions} postTriggerActions\n   *   The current PostTriggerActions instance.\n   */\n  constructor(\n    socket,\n    user,\n    gameChanger,\n    entityFinder,\n    userOperations,\n    postTriggerActions,\n  ) {\n    this.socket = socket;\n    this.user = user;\n    this.gameChanger = gameChanger;\n    this.entityFinder = entityFinder;\n    this.userOperations = userOperations;\n    this.postTriggerActions = postTriggerActions;\n    this.socketName = 'module.hey-wait';\n  }\n\n  /**\n   * Initialize any socket controller behaviour.\n   *\n   * @return {Promise<void>}\n   */\n  async init() {\n    await this._listen();\n  }\n\n  /**\n   * Deactivate the currently open socket.\n   *\n   * @return {Promise<void>}\n   */\n  async deactivate() {\n    await this._removeListener();\n  }\n\n  /**\n   * Emit any Hey, Wait! events that occurred.\n   *\n   * @param {string} tokenId\n   *   The ID of the Token that has collided with the Tile.\n   * @param {string} tileId\n   *   The ID of the Tile that the Token has collided with.\n   * @param {string} sceneId\n   *   The scene ID where this is taking place.\n   * @param {x,y} pos\n   *   The X and Y position where the event takes place.\n   *\n   * @return {Promise<void>}\n   *   The promise for what's taking place.\n   */\n  async emit(tokenId, tileId, sceneId, pos) {\n    global.console.debug(`hey-wait | Emitting to ${this.socketName}`);\n\n    this.socket.emit(\n      this.socketName,\n      {\n        tokenId, tileId, sceneId, pos,\n      },\n    );\n  }\n\n  /**\n   * Listen for events on our module's socket.\n   *\n   * Any event received will subsequently call the GameChanger to ensure the\n   * event takes place in the current user's game.\n   *\n   * @return {Promise<void>}\n   *\n   * @private\n   */\n  async _listen() {\n    this.socket.on(this.socketName, async (data) => {\n      global.console.debug(`hey-wait | Emission received on ${this.socketName}`);\n\n      try {\n        if (!this.userOperations.canChangeGameForUser(data.sceneId)) {\n          return;\n        }\n\n        // Change the game by potentially modifying the tile and pausing the\n        // game.\n        await this.gameChanger.execute(\n          data.tileId,\n          { x: data.pos.x, y: data.pos.y },\n          data.sceneId,\n        );\n\n        const tokenDoc = this.entityFinder.findTokenDocument(\n          data.tokenId,\n          data.sceneId,\n        );\n\n        if (!tokenDoc) {\n          global.console.error(`Could not find token document with ID ${data.tokenId}`);\n        }\n\n        const tile = this.entityFinder.findTile(data.tileId);\n        if (!tile) {\n          global.console.error(`Could not find Hey, Wait! tile with ID ${data.tileId}`);\n        }\n\n        await this.postTriggerActions.execute(tokenDoc, tile);\n      } catch (e) {\n        console.error(`hey-wait | ${e.name}: ${e.message}`);\n      }\n    });\n  }\n\n  /**\n   * Remove the associated socket listener.\n   *\n   * @return {Promise<void>}\n   *\n   * @private\n   */\n  async _removeListener() {\n    this.socket.off(this.socketName);\n  }\n}\n","/**\n * A class for auditing Tile entities pertaining to Hey, Wait!\n */\nexport default class TileAuditor {\n  /**\n   * Determine if the provided Tile is a Hey, Wait! tile.\n   *\n   * Includes checks if the tile has not yet been initialized but is destined\n   * to be a Hey, Wait! tile.\n   *\n   * @param {Tile} tile\n   *   The relevant Tile to check.\n   * @param {string} activeTool\n   *   The game's active tool being used.\n   *\n   * @return {boolean}\n   *   If this is a Hey, Wait! tile or not.\n   */\n  isHeyWaitTile(tile, activeTool) {\n    if (tile.data?._id) {\n      // Existing tile.\n      if (!tile.data?.flags?.['hey-wait']?.enabled) {\n        return false;\n      }\n    } else if (activeTool && activeTool !== 'heyWaitTile') {\n      // This is in a situation where we're placing a new tile and it's a\n      // Hey, Wait! tile, but we don't have flags or an ID setup yet.\n      return false;\n    }\n\n    return true;\n  }\n}\n","/* eslint-disable no-loop-func */\n/* eslint-disable no-await-in-loop */\n/* global CanvasAnimation */\n\n/**\n * A class to watch the animation cycles of a Token in Foundry.\n *\n * An \"animation\" is when a Token is being dragged across the Canvas.\n */\nexport default class TokenAnimationWatcher {\n  /**\n   * Watch the specific Token for its animation to be complete.\n   *\n   * @param {string} tokenId\n   *   The Token ID to watch for.\n   *\n   * @return {Promise}\n   */\n  async watchForCompletion(tokenId) {\n    // Create a \"timeout\" function which allows us to sleep for specific\n    // amounts of time.\n    // See https://stackoverflow.com/a/33292942/823549.\n    const timeout = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\n\n    // Check for the deletion of the animation key in the current animations\n    // to be sure that the animation has been successfully completed.\n    // This is hacky but unfortunately I'm unsure of another way to listen\n    // for animations being completed.\n    // This should allow for a buffer of 20 seconds to allow the animation to\n    // finish which theoretically should be more than enough time.\n    for (let i = 1; i <= 200; i += 1) {\n      await timeout(100);\n      if (!CanvasAnimation.animations?.[this._getAnimationKeyFromTokenId(tokenId)]) {\n        return Promise.resolve();\n      }\n    }\n\n    return Promise.resolve();\n  }\n\n  /**\n   * Get the expected animation array key from the Token object.\n   *\n   * This is used to find the animation pertaining to the Token.\n   *\n   * @param {string} tokenId\n   *   The specified Token ID to find the animation for.\n   *\n   * @return {string}\n   *\n   * @private\n   */\n  _getAnimationKeyFromTokenId(tokenId) {\n    return `Token.${tokenId}.animateMovement`;\n  }\n}\n","/**\n * A class for calculations relating to Tokens.\n */\nexport default class TokenCalculator {\n  /**\n   * Calculate the center coordinates of the Token in the Scene.\n   * @param {Scene} scene\n   *   The relevant Scene.\n   * @param {Token} token\n   *   The relevant Token.\n   *\n   * @return {x,y}\n   *   The final X and Y coordinates.\n   */\n  calculateCoordinates(scene, token) {\n    const coords = {};\n\n    // In order to \"center\" our numbers, we'll need to get the in-between\n    // based on the grid size.\n    const gridSize = Number(scene.data.grid);\n    const width = Number(token.width) * gridSize;\n    const height = Number(token.height) * gridSize;\n\n    // Take into account the width of the token - some may be larger than 1.\n    coords.x = Math.round(\n      token.x + (width / 2),\n    );\n    coords.y = Math.round(\n      token.y + (height / 2),\n    );\n\n    return coords;\n  }\n}\n","/* eslint-disable no-console */\n\n/**\n * Coordinate any Token updates from the Foundry Hook system.\n */\nexport default class TokenUpdateCoordinator {\n  /**\n   * TokenUpdateCoordinator constructor.\n   *\n   * @param {TriggeringHandler} triggeringHandler\n   *   The injected TriggeringHandler dependency.\n   * @param {PostTriggerActions} postTriggerActions\n   *   The injected PostTriggerActions dependency.\n   * @param {SocketController} socketController\n   *   The injected SocketController dependency.\n   */\n  constructor(\n    triggeringHandler,\n    postTriggerActions,\n    socketController,\n  ) {\n    this.triggeringHandler = triggeringHandler;\n    this.postTriggerActions = postTriggerActions;\n    this.socketController = socketController;\n\n    /**\n     * Keep track of the Token's initial position between updates.\n     *\n     * @type {Map<any, any>}\n     */\n    this.tokenInitPos = new Map();\n  }\n\n  /**\n   * Register the Token's initial position to be used later.\n   *\n   * We need to cache this in memory as the next update does not contain the\n   * relevant starting info.\n   *\n   * @param {Token} token\n   *   The Token to be registered.\n   */\n  registerTokenInitPos(token) {\n    if (!token) {\n      return;\n    }\n\n    this.tokenInitPos.set(\n      token._id,\n      {\n        x: token.x,\n        y: token.y,\n      },\n    );\n  }\n\n  /**\n   * Coordinate a Token update.\n   *\n   * Checks all applicable tiles for if they have been triggered or not. If\n   * they have, execute the functionality for triggering a tile.\n   *\n   * @param {TokenDocument} tokenDoc\n   *   The Token document getting updated.\n   * @param {Array} tiles\n   *   All of the potential tiles to check for triggers.\n   */\n  async coordinateUpdate(tokenDoc, tiles) {\n    const t0 = global.performance.now();\n\n    // Let's find the previously stored Token initial position.\n    const initPos = this.tokenInitPos.get(tokenDoc.id);\n\n    if (!initPos) {\n      // We may not have created an update queued previously, due to a\n      // lightweight update or something else. Just cleanup and exit.\n      this._cleanQueuedTokenInitPos(tokenDoc.id);\n      return;\n    }\n\n    const triggeredTile = await this.triggeringHandler.handleTileTriggering(\n      tiles,\n      tokenDoc,\n      initPos,\n      tokenDoc.parent.id,\n    );\n\n    if (triggeredTile) {\n      const token = tokenDoc.object;\n\n      this.socketController.emit(\n        tokenDoc.id,\n        triggeredTile.id,\n        tokenDoc.parent.id,\n        { x: token.x, y: token.y },\n      );\n      await this.postTriggerActions.execute(tokenDoc, triggeredTile);\n    }\n\n    const t1 = global.performance.now();\n    console.debug(`hey-wait | \\`coordinateUpdate\\` took ${t1 - t0}ms.`);\n\n    this._cleanQueuedTokenInitPos(tokenDoc.id);\n  }\n\n  /**\n   * Clean up any queued Tokens initial positions pertaining to the provided\n   * Token ID.\n   *\n   * @param {string} tokenId\n   *   The associated Token ID with the queued initial position.\n   *\n   * @private\n   */\n  _cleanQueuedTokenInitPos(tokenId) {\n    this.tokenInitPos.delete(tokenId);\n  }\n}\n","import Constants from './Constants';\n\n/**\n * A class for determining if specific user operations are allowed.\n */\nexport default class UserOperations {\n  constructor(user, settings) {\n    this.user = user;\n    this.settings = settings;\n  }\n\n  /**\n   * Determine if we can change the scene and warp, pan, etc. for the current\n   * user.\n   *\n   * @param {string} sceneId\n   *   The target scene ID.\n   *\n   * @return {boolean}\n   *   If we should change the scene or not.\n   */\n  canChangeGameForUser(sceneId) {\n    if (\n      this.user.isGM\n      || this.user.viewedScene === sceneId\n    ) {\n      return true;\n    }\n\n    const warpPlayers = this.settings.get(\n      Constants.MODULE_NAME,\n      'warp-players',\n    );\n\n    return !!warpPlayers;\n  }\n}\n","import Constants from '../Constants';\n\n/**\n * A class for dealing with logic relating to Token hooks called by Foundry.\n */\nexport default class TokenHooks {\n  constructor(user, settings) {\n    this.user = user;\n    this.settings = settings;\n  }\n\n  /**\n   * Determine of we can run logic for the \"update Token\" hook.\n   *\n   * @param {object} change\n   *   The `change` object provided by the hook.\n   * @param {number} disposition\n   *   The disposition of the token. See `CONST.TOKEN_DISPOSITION`.\n   * @param {boolean} isPaused\n   *   If the game is current pause or not.\n   *\n   * @returns {boolean}\n   */\n  canRunTokenUpdate(change, disposition, isPaused) {\n    if (isPaused) {\n      return false;\n    }\n\n    // Exit early if there's no relevant updates. Specifically, if the token\n    // has not moved.\n    if (!this._hasDataChanged(change)) {\n      return false;\n    }\n\n    if (!this._isUserAllowed()) {\n      return false;\n    }\n\n    if (!this._isDispositionAllowed(disposition)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Determine if the token data has changed.\n   *\n   * @param {object} change\n   *   The `change` object supplied by the hook.\n   * @returns {boolean}\n   *   If the data has changed.\n   *\n   * @private\n   */\n  _hasDataChanged(change) {\n    return Boolean(\n      change?.x !== undefined || change?.y !== undefined,\n    );\n  }\n\n  /**\n   * Determine if the current user is allowed to perform the token update.\n   *\n   * @returns {boolean}\n   *   If the user is allowed to trigger the update.\n   *\n   * @private\n   */\n  _isUserAllowed() {\n    if (!this.user.isGM) {\n      return true;\n    }\n\n    const restrictGm = this.settings.get(\n      Constants.MODULE_NAME,\n      'restrict-gm',\n    );\n\n    // If we are restricting a GM from triggering Hey, Wait! tiles, let's exit\n    // early so they don't move through the triggering flow.\n    if (restrictGm) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Determine if the token's disposition allows it for Hey, Wait! updates.\n   *\n   * @param {number} disposition\n   *   The token's disposition. See `CONST.TOKEN_DISPOSITIONS`.\n   * @returns {boolean}\n   *   If the token's disposition is allowed.\n   *\n   * @private\n   */\n  _isDispositionAllowed(disposition) {\n    // If we have a friendly disposition, it will always be allowed.\n    if (disposition === global.CONST.TOKEN_DISPOSITIONS.FRIENDLY) {\n      return true;\n    }\n\n    const choices = Constants.DISPOSITION_CHOICES;\n    const dispositionsAllowed = this.settings.get(\n      Constants.MODULE_NAME,\n      'disposition',\n    );\n\n    // If we have a neutral disposition, it's only allowed if we're allowing\n    // neutral and hostile.\n    if (\n      disposition === global.CONST.TOKEN_DISPOSITIONS.NEUTRAL\n      && [choices.FRIENDLY_NETURAL, choices.FRIENDLY_NEUTRAL_HOSTILE].includes(dispositionsAllowed)\n    ) {\n      return true;\n    }\n\n    // If we have a hostile disposition, it's only allowed if we allow all\n    // dispositions.\n    if (\n      disposition === global.CONST.TOKEN_DISPOSITIONS.HOSTILE\n      && dispositionsAllowed === choices.FRIENDLY_NEUTRAL_HOSTILE\n    ) {\n      return true;\n    }\n\n    return false;\n  }\n}\n","/* global game */\n\nimport Constants from './Constants';\n\nexport default () => {\n  const dispositionChoices = {};\n  dispositionChoices[Constants.DISPOSITION_CHOICES.FRIENDLY] = game.i18n.localize(\n    'HEYWAIT.SETTINGS.dispositionChoiceFriendly',\n  );\n  dispositionChoices[Constants.DISPOSITION_CHOICES.FRIENDLY_NETURAL] = game.i18n.localize(\n    'HEYWAIT.SETTINGS.dispositionChoiceFriendlyNeutral',\n  );\n  dispositionChoices[Constants.DISPOSITION_CHOICES.FRIENDLY_NEUTRAL_HOSTILE] = game.i18n.localize(\n    'HEYWAIT.SETTINGS.dispositionChoiceFriendlyNeutralHostile',\n  );\n\n  game.settings.register(Constants.MODULE_NAME, 'disposition', {\n    name: game.i18n.localize('HEYWAIT.SETTINGS.dispositionName'),\n    hint: game.i18n.localize('HEYWAIT.SETTINGS.dispositionHint'),\n    scope: 'world',\n    config: true,\n    default: Constants.DISPOSITION_CHOICES.FRIENDLY,\n    type: Number,\n    choices: dispositionChoices,\n  });\n\n  game.settings.register(Constants.MODULE_NAME, 'restrict-gm', {\n    name: game.i18n.localize('HEYWAIT.SETTINGS.restrictGmName'),\n    hint: game.i18n.localize('HEYWAIT.SETTINGS.restrictGmHint'),\n    scope: 'world',\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n\n  game.settings.register(Constants.MODULE_NAME, 'warp-players', {\n    name: game.i18n.localize('HEYWAIT.SETTINGS.warpPlayersName'),\n    hint: game.i18n.localize('HEYWAIT.SETTINGS.warpPlayersHint'),\n    scope: 'world',\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n  game.settings.register(Constants.MODULE_NAME, 'disable-sfx', {\n    name: game.i18n.localize('HEYWAIT.SETTINGS.disableSfxName'),\n    hint: game.i18n.localize('HEYWAIT.SETTINGS.disableSfxHint'),\n    scope: 'world',\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n};\n","import Constants from '../Constants';\n\n/**\n * A class to handle execution of any post-trigger actions needed.\n */\nexport default class PostTriggerActions {\n  /**\n   * PostTriggerActions constructor.\n   *\n   * @param {GameChanger} gameChanger\n   * @param {MacroOperations} macroOperations\n   * @param {ReactionCoordinator} reactionCoordinator\n   */\n  constructor(gameChanger, macroOperations, reactionCoordinator) {\n    this.gameChanger = gameChanger;\n    this.macroOperations = macroOperations;\n    this.reactionCoordinator = reactionCoordinator;\n  }\n\n  /**\n   * Run any post-triggering functionality for Hey, Wait! tiles.\n   *\n   * @param {TokenDocument} tokenDoc\n   *   The TokenDocument which triggered the Hey, Wait! tile.\n   * @param {Tile} tile\n   *   The Tile which was triggered.\n   */\n  async execute(tokenDoc, tile) {\n    // 1. Fire the associated macro with the Hey, Wait! tile if one's defined.\n    this.macroOperations.handleTileMacroFiring(tile.id, tokenDoc);\n    const token = tokenDoc.object;\n\n    // 2. Pan to the trigger location.\n    const coords = { x: token.x, y: token.y };\n    await this.gameChanger.pan(coords);\n\n    // 3. Handle the relevant reaction if one's defined.\n    const animType = tile.data?.flags?.['hey-wait']?.animType\n      ?? Constants.DEFAULT_ANIM_TYPE;\n\n    this\n      .reactionCoordinator\n      .handleTokenReaction(tokenDoc.parent, token, animType);\n  }\n}\n","/* eslint-disable no-console */\n\n/* global _levels */\n/* global _levelsModuleName */\n\n/**\n * A class to handle any triggering logic and tile modification operations.\n */\nexport default class TriggeringHandler {\n  /**\n   * TriggeringHandler constructor.\n   *\n   * @param {Collision} collision\n   *   The injected Collision dependency.\n   * @param {TriggerActions} triggerActions\n   *   The injected TriggerActions dependency.\n   */\n  constructor(\n    collision,\n    gameChanger,\n    tokenAnimationWatcher,\n  ) {\n    this.collision = collision;\n    this.gameChanger = gameChanger;\n    this.tokenAnimationWatcher = tokenAnimationWatcher;\n  }\n\n  /**\n   * Handle the tile triggering, and take action if a tile is triggered.\n   *\n   * @param {Array} tiles\n   *   The Tiles to check for triggering.\n   * @param {TokenDocument} tokenDoc\n   *   The TokenDocument to check the trigger from.\n   * @param {x,y} initPos\n   *   The initial position of the Token.\n   * @param {string} viewedSceneId\n   *   The ID of the currently viewed scene.\n   *\n   * @return {Promise<Tile|null>}\n   */\n  async handleTileTriggering(tiles, tokenDoc, initPos, viewedSceneId) {\n    const token = tokenDoc.object;\n\n    for (const tile of tiles) {\n      if (!this._isTileTriggered(tile, tokenDoc, initPos)) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      try {\n        // eslint-disable-next-line no-await-in-loop\n        await this.gameChanger.execute(\n          tile.id,\n          { x: token.x, y: token.y },\n          viewedSceneId,\n        );\n      } catch (e) {\n        global.console.error(`hey-wait | ${e.name}: ${e.message}`);\n      }\n\n      // eslint-disable-next-line no-await-in-loop\n      await this.tokenAnimationWatcher.watchForCompletion(tokenDoc.id);\n\n      return Promise.resolve(tile);\n    }\n\n    return Promise.resolve(null);\n  }\n\n  /**\n   * Determine if the tile has been triggered by the token's movement.\n   *\n   * @param {Tile} tile\n   *   The Tile to check for.\n   * @param {TokenDocument} tokenDoc\n   *   The TokenDocument to check for.\n   * @param {x,y} initTokenPos\n   *   The initial position of the Token before it was updated. X and Y values.\n   *\n   * @return {boolean}\n   *   If the tile has been triggered by the token's movement.\n   */\n  _isTileTriggered(tile, tokenDoc, initTokenPos) {\n    if (!this._isHeyWaitTile(tile)) {\n      return false;\n    }\n\n    if (!this._checkIsValidWithOtherModules(tile, tokenDoc.object)) {\n      return false;\n    }\n\n    if (this._isPreviouslyTriggered(tile)) {\n      return false;\n    }\n\n    if (!this.collision.checkTileTokenCollision(tile, tokenDoc.object, initTokenPos)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * If the tile is a valid Hey, Wait! tile.\n   *\n   * @param {Tile} tile\n   *   The relevant Tile for checking.\n   *\n   * @return {boolean}\n   *\n   * @private\n   */\n  _isHeyWaitTile(tile) {\n    return Boolean(\n      tile.data?.flags?.['hey-wait']?.enabled,\n    );\n  }\n\n  _checkIsValidWithOtherModules(tile, token) {\n    // If the Levels module is enabled, ensure we don't trigger on a wrong level.\n    if (\n      typeof _levels !== 'undefined'\n      && typeof _levelsModuleName !== 'undefined'\n      && !_levels.isTokenInRange(token, tile)\n    ) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * If the tile was previously triggered.\n   *\n   * @param {Tile} tile\n   *   The relevant Tile for checking.\n   *\n   * @return {boolean}\n   *\n   * @private\n   */\n  _isPreviouslyTriggered(tile) {\n    return Boolean(\n      tile.data?.flags?.['hey-wait']?.triggered,\n    );\n  }\n}\n","var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar penner = createCommonjsModule(function (module, exports) {\n/*\n\tCopyright © 2001 Robert Penner\n\tAll rights reserved.\n\n\tRedistribution and use in source and binary forms, with or without modification, \n\tare permitted provided that the following conditions are met:\n\n\tRedistributions of source code must retain the above copyright notice, this list of \n\tconditions and the following disclaimer.\n\tRedistributions in binary form must reproduce the above copyright notice, this list \n\tof conditions and the following disclaimer in the documentation and/or other materials \n\tprovided with the distribution.\n\n\tNeither the name of the author nor the names of contributors may be used to endorse \n\tor promote products derived from this software without specific prior written permission.\n\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY \n\tEXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n\tMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n\tCOPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n\tEXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n\tGOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED \n\tAND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n\tNEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED \n\tOF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n(function() {\n  var penner, umd;\n\n  umd = function(factory) {\n    {\n      return module.exports = factory;\n    }\n  };\n\n  penner = {\n    linear: function(t, b, c, d) {\n      return c * t / d + b;\n    },\n    easeInQuad: function(t, b, c, d) {\n      return c * (t /= d) * t + b;\n    },\n    easeOutQuad: function(t, b, c, d) {\n      return -c * (t /= d) * (t - 2) + b;\n    },\n    easeInOutQuad: function(t, b, c, d) {\n      if ((t /= d / 2) < 1) {\n        return c / 2 * t * t + b;\n      } else {\n        return -c / 2 * ((--t) * (t - 2) - 1) + b;\n      }\n    },\n    easeInCubic: function(t, b, c, d) {\n      return c * (t /= d) * t * t + b;\n    },\n    easeOutCubic: function(t, b, c, d) {\n      return c * ((t = t / d - 1) * t * t + 1) + b;\n    },\n    easeInOutCubic: function(t, b, c, d) {\n      if ((t /= d / 2) < 1) {\n        return c / 2 * t * t * t + b;\n      } else {\n        return c / 2 * ((t -= 2) * t * t + 2) + b;\n      }\n    },\n    easeInQuart: function(t, b, c, d) {\n      return c * (t /= d) * t * t * t + b;\n    },\n    easeOutQuart: function(t, b, c, d) {\n      return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n    },\n    easeInOutQuart: function(t, b, c, d) {\n      if ((t /= d / 2) < 1) {\n        return c / 2 * t * t * t * t + b;\n      } else {\n        return -c / 2 * ((t -= 2) * t * t * t - 2) + b;\n      }\n    },\n    easeInQuint: function(t, b, c, d) {\n      return c * (t /= d) * t * t * t * t + b;\n    },\n    easeOutQuint: function(t, b, c, d) {\n      return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n    easeInOutQuint: function(t, b, c, d) {\n      if ((t /= d / 2) < 1) {\n        return c / 2 * t * t * t * t * t + b;\n      } else {\n        return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n      }\n    },\n    easeInSine: function(t, b, c, d) {\n      return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\n    },\n    easeOutSine: function(t, b, c, d) {\n      return c * Math.sin(t / d * (Math.PI / 2)) + b;\n    },\n    easeInOutSine: function(t, b, c, d) {\n      return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;\n    },\n    easeInExpo: function(t, b, c, d) {\n      if (t === 0) {\n        return b;\n      } else {\n        return c * Math.pow(2, 10 * (t / d - 1)) + b;\n      }\n    },\n    easeOutExpo: function(t, b, c, d) {\n      if (t === d) {\n        return b + c;\n      } else {\n        return c * (-Math.pow(2, -10 * t / d) + 1) + b;\n      }\n    },\n    easeInOutExpo: function(t, b, c, d) {\n      if ((t /= d / 2) < 1) {\n        return c / 2 * Math.pow(2, 10 * (t - 1)) + b;\n      } else {\n        return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;\n      }\n    },\n    easeInCirc: function(t, b, c, d) {\n      return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n    },\n    easeOutCirc: function(t, b, c, d) {\n      return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n    },\n    easeInOutCirc: function(t, b, c, d) {\n      if ((t /= d / 2) < 1) {\n        return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;\n      } else {\n        return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n      }\n    },\n    easeInElastic: function(t, b, c, d) {\n      var a, p, s;\n      s = 1.70158;\n      p = 0;\n      a = c;\n      if (t === 0) ; else if ((t /= d) === 1) ;\n      if (!p) {\n        p = d * .3;\n      }\n      if (a < Math.abs(c)) {\n        a = c;\n        s = p / 4;\n      } else {\n        s = p / (2 * Math.PI) * Math.asin(c / a);\n      }\n      return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n    },\n    easeOutElastic: function(t, b, c, d) {\n      var a, p, s;\n      s = 1.70158;\n      p = 0;\n      a = c;\n      if (t === 0) ; else if ((t /= d) === 1) ;\n      if (!p) {\n        p = d * .3;\n      }\n      if (a < Math.abs(c)) {\n        a = c;\n        s = p / 4;\n      } else {\n        s = p / (2 * Math.PI) * Math.asin(c / a);\n      }\n      return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;\n    },\n    easeInOutElastic: function(t, b, c, d) {\n      var a, p, s;\n      s = 1.70158;\n      p = 0;\n      a = c;\n      if (t === 0) ; else if ((t /= d / 2) === 2) ;\n      if (!p) {\n        p = d * (.3 * 1.5);\n      }\n      if (a < Math.abs(c)) {\n        a = c;\n        s = p / 4;\n      } else {\n        s = p / (2 * Math.PI) * Math.asin(c / a);\n      }\n      if (t < 1) {\n        return -.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n      } else {\n        return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * .5 + c + b;\n      }\n    },\n    easeInBack: function(t, b, c, d, s) {\n      if (s === void 0) {\n        s = 1.70158;\n      }\n      return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n    easeOutBack: function(t, b, c, d, s) {\n      if (s === void 0) {\n        s = 1.70158;\n      }\n      return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n    easeInOutBack: function(t, b, c, d, s) {\n      if (s === void 0) {\n        s = 1.70158;\n      }\n      if ((t /= d / 2) < 1) {\n        return c / 2 * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n      } else {\n        return c / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n      }\n    },\n    easeInBounce: function(t, b, c, d) {\n      var v;\n      v = penner.easeOutBounce(d - t, 0, c, d);\n      return c - v + b;\n    },\n    easeOutBounce: function(t, b, c, d) {\n      if ((t /= d) < 1 / 2.75) {\n        return c * (7.5625 * t * t) + b;\n      } else if (t < 2 / 2.75) {\n        return c * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + b;\n      } else if (t < 2.5 / 2.75) {\n        return c * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + b;\n      } else {\n        return c * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + b;\n      }\n    },\n    easeInOutBounce: function(t, b, c, d) {\n      var v;\n      if (t < d / 2) {\n        v = penner.easeInBounce(t * 2, 0, c, d);\n        return v * .5 + b;\n      } else {\n        v = penner.easeOutBounce(t * 2 - d, 0, c, d);\n        return v * .5 + c * .5 + b;\n      }\n    }\n  };\n\n  umd(penner);\n\n}).call(commonjsGlobal);\n});\n\nvar eventemitter3 = createCommonjsModule(function (module) {\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\n{\n  module.exports = EventEmitter;\n}\n});\n\n/**\r\n * Controls a group of easings added by Ease.add()\r\n * @extends EventEmitter\r\n */\r\nclass Easing extends eventemitter3\r\n{\r\n    /**\r\n     * an easing that acts on an element or an array of elements\r\n     * @param {(PIXI.DisplayObject|PIXI.DisplayObject[])} element\r\n     * @param {object} params\r\n     * @param {object} options\r\n     * @extends EventEmitter\r\n     * @fires EaseElement#complete\r\n     * @fires EaseElement#each\r\n     * @fires EaseElement#complete\r\n     * @fires EaseElement#reverse\r\n     * @fires EaseElement#repeat\r\n     * @fires EaseElement#wait\r\n     * @fires EaseElement#wait-end\r\n     */\r\n    constructor(element, params, options)\r\n    {\r\n        super();\r\n\r\n        /**\r\n         * element(s) being eased\r\n         * @member {(PIXI.DisplayObject|PIXI.DisplayObject[])}\r\n         */\r\n        this.elements = Array.isArray(element) ? element : [element];\r\n        this.eases = [];\r\n        this.options = options || {};\r\n        this.time = 0;\r\n        for (let param in params)\r\n        {\r\n            for (let element of this.elements)\r\n            {\r\n                this.addParam(element, param, params[param]);\r\n            }\r\n        }\r\n    }\r\n\r\n    addParam(element, entry, param)\r\n    {\r\n        let start, to, delta, update, name = entry;\r\n        switch (entry)\r\n        {\r\n            case 'scaleX':\r\n            case 'skewX':\r\n                name = entry.substr(0, entry.length - 1);\r\n                start = element[name].x;\r\n                to = param;\r\n                delta = param - start;\r\n                update = ease => this.updateCoord(ease, name, 'x');\r\n                break\r\n\r\n            case 'scaleY':\r\n            case 'skewY':\r\n                name = entry.substr(0, entry.length - 1);\r\n                start = element[name].y;\r\n                to = param;\r\n                delta = param - start;\r\n                update = ease => this.updateCoord(ease, name, 'y');\r\n                break\r\n\r\n            case 'tint':\r\n            case 'blend':\r\n                const colors = Array.isArray(param) ? param : [element.tint, param];\r\n                start = 0;\r\n                to = colors.length;\r\n                delta = to;\r\n                update = (entry === 'tint') ? ease => this.updateTint(ease, colors) : ease => this.updateBlend(ease, colors);\r\n                break\r\n\r\n            case 'shake':\r\n                start = { x: element.x, y: element.y };\r\n                to = param;\r\n                update = ease => this.updateShake(ease);\r\n                break\r\n\r\n            case 'position':\r\n                start = { x: element.x, y: element.y };\r\n                to = { x: param.x, y: param.y };\r\n                delta = { x: to.x - start.x, y: to.y - start.y };\r\n                update = ease => this.updatePosition(ease);\r\n                break\r\n\r\n            case 'skew':\r\n            case 'scale':\r\n                start = element[entry].x;\r\n                to = param;\r\n                delta = param - start;\r\n                update = ease => this.updatePoint(ease, entry);\r\n                break\r\n\r\n            case 'face':\r\n                start = element.rotation;\r\n                to = Easing.shortestAngle(start, Math.atan2(param.y - element.y, param.x - element.x));\r\n                delta = to - start;\r\n                update = ease => this.updateOne(ease, 'rotation');\r\n                break\r\n\r\n            default:\r\n                start = element[entry];\r\n                to = param;\r\n                delta = param - start;\r\n                update = ease => this.updateOne(ease, entry);\r\n        }\r\n        this.eases.push({ element, entry, update, start, to, delta });\r\n    }\r\n\r\n    /**\r\n     * helper function to find closest angle to change between angle start and angle finish (used by face)\r\n     * @param {number} start angle\r\n     * @param {number} finish angle\r\n     * @private\r\n     */\r\n    static shortestAngle(start, finish)\r\n    {\r\n        function mod(a, n)\r\n        {\r\n            return (a % n + n) % n\r\n        }\r\n\r\n        const PI_2 = Math.PI * 2;\r\n        let diff = Math.abs(start - finish) % PI_2;\r\n        diff = diff > Math.PI ? (PI_2 - diff) : diff;\r\n\r\n        const simple = finish - start;\r\n        const sign = mod((simple + Math.PI), PI_2) - Math.PI > 0 ? 1 : -1;\r\n\r\n        return diff * sign\r\n    }\r\n\r\n    /**\r\n     * remove all easings with matching element and params\r\n     * @param {PIXI.DisplayObject} [element] if not set, removes all elements in this easing\r\n     * @param {(string|string[])} [params] if not set, removes all params for each element\r\n     */\r\n    remove(element, params)\r\n    {\r\n        if (arguments.length === 0)\r\n        {\r\n            this.eases = [];\r\n        }\r\n        else\r\n        {\r\n            if (typeof params === 'string')\r\n            {\r\n                params = [params];\r\n            }\r\n            for (let i = 0; i < this.eases.length; i++)\r\n            {\r\n                const ease = this.eases[i];\r\n                if ((!element || ease.element === element) && (!params || params.indexOf(ease.entry) !== -1))\r\n                {\r\n                    this.eases.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        if (this.eases.length === 0)\r\n        {\r\n            return true\r\n        }\r\n    }\r\n\r\n    updateOne(ease, entry)\r\n    {\r\n        ease.element[entry] = this.options.ease(this.time, ease.start, ease.delta, this.options.duration);\r\n    }\r\n\r\n    updatePoint(ease, entry)\r\n    {\r\n        ease.element[entry].x = ease.element[entry].y = this.options.ease(this.time, ease.start, ease.delta, this.options.duration);\r\n    }\r\n\r\n    updatePosition(ease)\r\n    {\r\n        ease.element.x = this.options.ease(this.time, ease.start.x, ease.delta.x, this.options.duration);\r\n        ease.element.y = this.options.ease(this.time, ease.start.y, ease.delta.y, this.options.duration);\r\n    }\r\n\r\n    updateCoord(ease, name, coord)\r\n    {\r\n        ease.element[name][coord] = this.options.ease(this.time, ease.start, ease.delta, this.options.duration);\r\n    }\r\n\r\n    updateTint(ease, colors)\r\n    {\r\n        let index = Math.floor(this.options.ease(this.time, ease.start, ease.delta, this.options.duration));\r\n        if (index === colors.length)\r\n        {\r\n            index = colors.length - 1;\r\n        }\r\n        ease.element.tint = colors[index];\r\n    }\r\n\r\n    updateBlend(ease, colors)\r\n    {\r\n        const calc = this.options.ease(this.time, ease.start, ease.delta, this.options.duration);\r\n        let index = Math.floor(calc);\r\n        if (index === colors.length)\r\n        {\r\n            index = colors.length - 1;\r\n        }\r\n        let next = index + 1;\r\n        if (next === colors.length)\r\n        {\r\n            next = this.options.reverse ? index - 1 : this.options.repeat ? 0 : index;\r\n        }\r\n        const percent = calc - index;\r\n        const color1 = colors[index];\r\n        const color2 = colors[next];\r\n        const r1 = color1 >> 16;\r\n        const g1 = color1 >> 8 & 0x0000ff;\r\n        const b1 = color1 & 0x0000ff;\r\n        const r2 = color2 >> 16;\r\n        const g2 = color2 >> 8 & 0x0000ff;\r\n        const b2 = color2 & 0x0000ff;\r\n        const percent1 = 1 - percent;\r\n        const r = percent1 * r1 + percent * r2;\r\n        const g = percent1 * g1 + percent * g2;\r\n        const b = percent1 * b1 + percent * b2;\r\n        ease.element.tint = r << 16 | g << 8 | b;\r\n    }\r\n\r\n    updateShake(ease)\r\n    {\r\n        function random(n)\r\n        {\r\n            return Math.floor(Math.random() * n) - Math.floor(n / 2)\r\n        }\r\n        ease.element.x = ease.start.x + random(ease.to);\r\n        ease.element.y = ease.start.y + random(ease.to);\r\n    }\r\n\r\n    complete(ease)\r\n    {\r\n        if (ease.entry === 'shake')\r\n        {\r\n            ease.element.x = ease.start.x;\r\n            ease.element.y = ease.start.y;\r\n        }\r\n    }\r\n\r\n    reverse(ease)\r\n    {\r\n        if (ease.entry === 'position')\r\n        {\r\n            const swapX = ease.to.x;\r\n            const swapY = ease.to.y;\r\n            ease.to.x = ease.start.x;\r\n            ease.to.y = ease.start.y;\r\n            ease.start.x = swapX;\r\n            ease.start.y = swapY;\r\n            ease.delta.x = -ease.delta.x;\r\n            ease.delta.y = -ease.delta.y;\r\n        }\r\n        else\r\n        {\r\n            const swap = ease.to;\r\n            ease.to = ease.start;\r\n            ease.start = swap;\r\n            ease.delta = -ease.delta;\r\n        }\r\n    }\r\n\r\n    repeat(ease)\r\n    {\r\n        switch (ease.entry)\r\n        {\r\n            case 'skewX':\r\n                ease.element.skew.x = ease.start;\r\n                break\r\n\r\n            case 'skewY':\r\n                ease.element.skew.y = ease.start;\r\n                break\r\n\r\n            case 'skew':\r\n                ease.element.skew.x = ease.start;\r\n                ease.element.skew.y = ease.start;\r\n                break\r\n\r\n            case 'scaleX':\r\n                ease.element.scale.x = ease.start;\r\n                break\r\n\r\n            case 'scaleY':\r\n                ease.element.scale.y = ease.start;\r\n                break\r\n\r\n            case 'scale':\r\n                ease.element.scale.x = ease.start;\r\n                ease.element.scale.y = ease.start;\r\n                break\r\n\r\n            case 'position':\r\n                ease.element.x = ease.start.x;\r\n                ease.element.y = ease.start.y;\r\n                break\r\n\r\n            default:\r\n                ease.element[ease.entry] = ease.start;\r\n        }\r\n    }\r\n\r\n    update(elapsed)\r\n    {\r\n        if (this.eases.length === 0)\r\n        {\r\n            return true\r\n        }\r\n        if (this.options.wait)\r\n        {\r\n            this.options.wait -= elapsed;\r\n            if (this.options.wait > 0)\r\n            {\r\n                this.emit('wait', this);\r\n                return\r\n            }\r\n            else\r\n            {\r\n                elapsed = -this.options.wait;\r\n                this.options.wait = 0;\r\n                this.emit('wait-end', this);\r\n            }\r\n        }\r\n        this.time += elapsed;\r\n        let leftover = 0;\r\n        if (this.time >= this.options.duration)\r\n        {\r\n            leftover = this.time - this.options.duration;\r\n            this.time = this.options.duration;\r\n        }\r\n        for (let i = 0; i < this.eases.length; i++)\r\n        {\r\n            const ease = this.eases[i];\r\n            if (ease.element._destroyed)\r\n            {\r\n                this.eases.splice(i, 1);\r\n                i--;\r\n            }\r\n            else\r\n            {\r\n                ease.update(ease);\r\n            }\r\n        }\r\n        this.emit('each', this);\r\n        if (this.time >= this.options.duration)\r\n        {\r\n            if (this.options.reverse)\r\n            {\r\n                this.eases.forEach(ease => this.reverse(ease));\r\n                this.time = leftover;\r\n                if (leftover)\r\n                {\r\n                    this.eases.forEach(ease => ease.update(ease));\r\n                }\r\n                this.emit('reverse', this);\r\n                if (!this.options.repeat)\r\n                {\r\n                    this.options.reverse = false;\r\n                }\r\n                else if (this.options.repeat !== true)\r\n                {\r\n                    this.options.repeat--;\r\n                }\r\n            }\r\n            else if (this.options.repeat)\r\n            {\r\n                this.eases.forEach(ease => this.repeat(ease));\r\n                this.time = leftover;\r\n                if (leftover)\r\n                {\r\n                    this.eases.forEach(ease => ease.update(ease));\r\n                }\r\n                if (this.options.repeat !== true)\r\n                {\r\n                    this.options.repeat--;\r\n                }\r\n                this.emit('repeat', this);\r\n            }\r\n            else\r\n            {\r\n                this.eases.forEach(ease => this.complete(ease));\r\n                this.emit('complete', this);\r\n                return true\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * number of parameters being eased\r\n     * @returns {number}\r\n     */\r\n    get count()\r\n    {\r\n        return this.eases.length\r\n    }\r\n}\r\n\r\n/**\r\n * fires when easings are finished\r\n * @event EaseElement#complete\r\n * @type {EaseElement}\r\n */\r\n\r\n/**\r\n * fires on each loop where there are easings\r\n * @event EaseElement#each\r\n * @type {EaseElement}\r\n */\r\n\r\n/**\r\n * fires when easings repeats\r\n * @event EaseElement#repeat\r\n * @type {EaseElement}\r\n */\r\n\r\n /**\r\n * fires when easings reverse\r\n * @event EaseElement#reverse\r\n * @type {EaseElement}\r\n */\r\n\r\n/**\r\n * fires on each frame while a wait is counting down\r\n * @event EaseElement#wait\r\n * @type {object}\r\n * @property {EaseElement} element\r\n * @property {number} wait\r\n */\r\n\r\n/**\r\n * fires after a wait expires\r\n * @event EaseElement#wait-end\r\n * @type { EaseElement }\r\n */\n\nconst easeOptions = {\r\n    duration: 1000,\r\n    ease: penner.easeInOutSine,\r\n    maxFrame: 1000 / 60,\r\n    ticker: null,\r\n    useRAF: true\r\n};\r\n\r\n/**\r\n * Manages a group of eases\r\n * @extends EventEmitter\r\n * @example\r\n * import * as PIXI from 'pixi.js'\r\n * import { Ease, ease } from 'pixi-ease'\r\n *\r\n * const app = new PIXI.Application()\r\n * const test = app.stage.addChild(new PIXI.Sprite(PIXI.Texture.WHITE))\r\n *\r\n * const move = ease.add(test, { x: 20, y: 15, alpha: 0.25 }, { reverse: true })\r\n * move.once('complete', () => console.log('move ease complete.'))\r\n *\r\n * test.generic = 25\r\n * const generic = ease.add(test, { generic: 0 }, { duration: 1500, ease: 'easeOutQuad' })\r\n * generic.on('each', () => console.log(test.generic))\r\n *\r\n * const secondEase = new Ease({ duration: 3000, ease: 'easeInBack' })\r\n * const test2 = app.stage.addChild(new PIXI.Sprite(PIXI.Texture.WHITE))\r\n * test2.tint = 0x0000ff\r\n * secondEase.add(test2, { blend: [0xff0000, 0x00ff00], scale: 2 })\r\n */\r\nclass Ease extends eventemitter3\r\n{\r\n    /**\r\n     * @param {object} [options]\r\n     * @param {number} [options.duration=1000] default duration if not set\r\n     * @param {(string|function)} [options.ease=Penner.easeInOutSine] default ease function if not set (see {@link https://www.npmjs.com/package/penner} for names of easing functions)\r\n     * @param {boolean} [option.useRAF=true] attach to a requestAnimationFrame listener\r\n     * @param {PIXI.Ticker} [options.ticker] attach to a PIXI.Ticker instead of RAF\r\n     * @param {number} [options.maxFrame=1000/60] maximum frame time (set to Infinity to ignore); only used if useTicker = true\r\n     * @fires Ease#complete\r\n     * @fires Ease#each\r\n     */\r\n    constructor(options)\r\n    {\r\n        super();\r\n        this.options = Object.assign({}, easeOptions, options);\r\n        this.easings = [];\r\n        this.empty = true;\r\n        if (this.options.ticker)\r\n        {\r\n            this.options.ticker.add(this.update, this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * removes all eases and tickers\r\n     */\r\n    destroy()\r\n    {\r\n        this.removeAll();\r\n        if (this.options.useTicker)\r\n        {\r\n            this.ticker.remove(this.update, this);\r\n        }\r\n        else if (this.options.useRAF)\r\n        {\r\n            cancelAnimationFrame(this.handleRAF);\r\n            this.handleRAF = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * add ease(s) to a PIXI.DisplayObject element\r\n     * @param {(PIXI.DisplayObject|PIXI.DisplayObject[])} element\r\n     *\r\n     * @param {object} params\r\n     * @param {number} [params.x]\r\n     * @param {number} [params.y]\r\n     * @param {(PIXI.DisplayObject|PIXI.Point)} [params.position] changes both x and y\r\n     * @param {number} [params.width]\r\n     * @param {number} [params.height]\r\n     * @param {number} [params.scale] changes both scale.x and scale.y\r\n     * @param {number} [params.scaleX]\r\n     * @param {number} [params.scaleY]\r\n     * @param {number} [params.alpha]\r\n     * @param {number} [params.rotation]\r\n     * @param {(PIXI.DisplayObject|PIXI.Point)} [params.face] rotate the element to face a DisplayObject using the closest angle\r\n     * @param {number} [params.skew] changes both skew.x and skew.y\r\n     * @param {number} [params.skewX]\r\n     * @param {number} [params.skewY]\r\n     * @param {(number|number[])} [params.tint] cycle through colors - if number is provided then it cycles between current tint and number; if number[] is provided is cycles only between tints in the number[]\r\n     * @param {(number|number[])} [params.blend] blend between colors - if number is provided then it blends current tint to number; if number[] is provided then it blends between the tints in the number[]\r\n     * @param {number} [params.shake] shakes the object by this number (randomly placing the element +/-shake pixels away from starting point)\r\n     * @param {number} [params.*] generic number parameter\r\n     *\r\n     * @param {object} [options]\r\n     * @param {number} [options.duration]\r\n     * @param {(string|function)} [options.ease]\r\n     * @param {(boolean|number)} [options.repeat]\r\n     * @param {boolean} [options.reverse]\r\n     * @param {number} [options.wait] wait this number of milliseconds before ease starts\r\n     *\r\n     * @returns {Easing}\r\n     */\r\n    add(element, params, options)\r\n    {\r\n        options = options || {};\r\n        options.duration = typeof options.duration !== 'undefined' ? options.duration : this.options.duration;\r\n        options.ease = options.ease || this.options.ease;\r\n        if (typeof options.ease === 'string')\r\n        {\r\n            options.ease = penner[options.ease];\r\n        }\r\n        const easing = new Easing(element, params, options);\r\n        this.easings.push(easing);\r\n        if (this.empty && this.options.useRAF)\r\n        {\r\n            this.handleRAF = requestAnimationFrame(() => this.update());\r\n            this.lastTime = Date.now();\r\n        }\r\n        this.empty = false;\r\n        return easing\r\n    }\r\n\r\n    /**\r\n     * create an ease that changes position (x, y) of the element by moving to the target at the speed\r\n     * NOTE: under the hood this calls add(element, { x, y }, { duration: <calculated speed based on distance and speed> })\r\n     * @param {PIXI.DisplayObject} element\r\n     * @param {(PIXI.DisplayObject|PIXI.Point)} target\r\n     * @param {number} speed in pixels / ms\r\n     *\r\n     * @param {object} [options]\r\n     * @param {(string|function)} [options.ease]\r\n     * @param {(boolean|number)} [options.repeat]\r\n     * @param {boolean} [options.reverse]\r\n     * @param {number} [options.wait] wait this number of milliseconds before ease starts\r\n     * @param {boolean} [options.removeExisting] removes existing eases on the element of the same type (including x,y/position, skewX,skewY/skew, scaleX,scaleY/scale)\r\n     *\r\n     * @returns {Easing}\r\n     */\r\n    target(element, target, speed, options)\r\n    {\r\n        const duration = Math.sqrt(Math.pow(element.x - target.x, 2) + Math.pow(element.y - target.y, 2)) / speed;\r\n        options = options || {};\r\n        options.duration = duration;\r\n        return this.add(element, { x: target.x, y: target.y }, options)\r\n    }\r\n\r\n    /**\r\n     * helper function to add an ease that changes rotation to face the element at the desired target using the speed\r\n     * NOTE: under the hood this calls add(element {x, y }, { duration: <calculated speed based on shortest rotation and speed> })\r\n     * @param {PIXI.DisplayObject} element\r\n     * @param {(PIXI.DisplayObject|PIXI.Point)} target\r\n     * @param {number} speed in radians / ms\r\n     *\r\n     * @param {object} [options]\r\n     * @param {(string|function)} [options.ease]\r\n     * @param {(boolean|number)} [options.repeat]\r\n     * @param {boolean} [options.reverse]\r\n     * @param {number} [options.wait] wait this number of milliseconds before ease starts\r\n     *\r\n     * @returns {Easing}\r\n     */\r\n    face(element, target, speed, options)\r\n    {\r\n        const shortestAngle = Easing.shortestAngle(element.rotation, Math.atan2(target.y - element.y, target.x - element.x));\r\n        const duration = Math.abs(shortestAngle - element.rotation) / speed;\r\n        options = options || {};\r\n        options.duration = duration;\r\n        return this.add(element, { rotation: shortestAngle }, options)\r\n    }\r\n\r\n    /**\r\n     * removes one or more eases from a DisplayObject\r\n     * WARNING: 'complete' events will not fire for these removals\r\n     * @param {PIXI.DisplayObject} element\r\n     * @param {(string|string[])} [param] omit to remove all easings for an element\r\n     */\r\n    removeEase(element, param)\r\n    {\r\n        for (let i = 0; i < this.easings.length; i++)\r\n        {\r\n            if (this.easings[i].remove(element, param))\r\n            {\r\n                this.easings.splice(i, 1);\r\n                i--;\r\n            }\r\n        }\r\n        if (this.easings.length === 0)\r\n        {\r\n            this.empty = true;\r\n            if (this.options.useRAF && this.handleRAF)\r\n            {\r\n                cancelAnimationFrame(this.handleRAF);\r\n                this.handleRAF = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * remove all easings\r\n     * WARNING: 'complete' events will not fire for these removals\r\n     */\r\n    removeAll()\r\n    {\r\n        this.easings = [];\r\n        this.empty = true;\r\n        if (this.options.useRAF && this.handleRAF)\r\n        {\r\n            cancelAnimationFrame(this.handleRAF);\r\n            this.handleRAF = null;\r\n        }\r\n}\r\n\r\n    /**\r\n     * update frame; this is called automatically if options.useTicker !== false\r\n     * @param {number} elapsed time in ms since last frame\r\n     */\r\n    update(elapsed)\r\n    {\r\n        if (this.options.useTicker)\r\n        {\r\n            elapsed = this.ticker.elapsedMS;\r\n        }\r\n        else if (this.options.useRAF)\r\n        {\r\n            const now = Date.now();\r\n            elapsed = now - this.lastTime;\r\n            this.lastTime = now;\r\n        }\r\n        elapsed = Math.min(elapsed, this.options.maxFrame);\r\n        if (!this.empty)\r\n        {\r\n            const list = this.easings.slice(0);\r\n            for (let easing of list)\r\n            {\r\n                if (easing.update(elapsed))\r\n                {\r\n                    this.easings.splice(this.easings.indexOf(easing), 1);\r\n                }\r\n            }\r\n            this.emit('each', this);\r\n            if (this.easings.length === 0)\r\n            {\r\n                this.empty = true;\r\n                this.emit('complete', this);\r\n            }\r\n        }\r\n        if (this.options.useRAF && this.easings.length)\r\n        {\r\n            this.handleRAF = requestAnimationFrame(() => this.update());\r\n        }\r\n        else\r\n        {\r\n            this.handleRAF = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * number of easings\r\n     * @type {number}\r\n     */\r\n    get count()\r\n    {\r\n        return this.easings.length\r\n    }\r\n\r\n    /**\r\n     * number of active easings across all elements\r\n     * @returns {number}\r\n     */\r\n    countRunning()\r\n    {\r\n        let count = 0;\r\n        for (let entry of this.easings)\r\n        {\r\n            count += entry.count;\r\n        }\r\n        return count\r\n    }\r\n\r\n    /**\r\n     * default duration for eases.add() (only applies to newly added eases)\r\n     * @type {number}\r\n     */\r\n    set duration(duration)\r\n    {\r\n        this.options.duration = duration;\r\n    }\r\n    get duration()\r\n    {\r\n        return this.options.duration\r\n    }\r\n\r\n    /**\r\n     * default ease for eases.add() (only applies to newly added eases)\r\n     * @type {(string|Function)}\r\n     */\r\n    set ease(ease)\r\n    {\r\n        this.options.ease = ease;\r\n    }\r\n    get ease()\r\n    {\r\n        return this.options.ease\r\n    }\r\n}\r\n\r\n// manages the ids used to define the DisplayObject ease variable (enabled multiple eases attached to the same object)\r\nEase.id = 0;\r\n\r\n/**\r\n * default instantiated Ease class\r\n * @type {Ease}\r\n */\r\nlet ease = new Ease();\r\n\r\nEase.ease = ease;\r\n\r\nclass List\r\n{\r\n    constructor()\r\n    {\r\n        console.warn('Ease.List was deprecated. Use new Ease() instead.');\r\n    }\r\n}\r\n\r\n/**\r\n * fires when there are no more eases\r\n * @event Ease#complete\r\n * @type {Ease}\r\n */\r\n\r\n /**\r\n * fires on each loop when there are eases running\r\n * @event Ease#each\r\n * @type {Ease}\r\n */\n\nexport { Ease, List, ease };\n//# sourceMappingURL=ease.es.js.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * The main entry point for \"Hey, Wait!\".\n *\n * Author: 1000Nettles\n * Content License: MIT\n * Software License: MIT\n */\n\nimport { ease } from 'pixi-ease';\nimport registerSettings from './module/settings';\nimport ControlsGenerator from './module/ControlsGenerator';\nimport Collision from './module/Collision';\nimport TriggeringHandler from './module/triggering/TriggeringHandler';\nimport PostTriggerActions from './module/triggering/PostTriggerActions';\nimport TileAuditor from './module/TileAuditor';\nimport Constants from './module/Constants';\nimport SocketController from './module/SocketController';\nimport TokenUpdateCoordinator from './module/TokenUpdateCoordinator';\nimport GameChanger from './module/GameChanger';\nimport Animator from './module/Animator';\nimport TokenCalculator from './module/TokenCalculator';\nimport ReactionCoordinator from './module/ReactionCoordinator';\nimport EntityFinder from './module/EntityFinder';\nimport TokenAnimationWatcher from './module/TokenAnimationWatcher';\nimport UserOperations from './module/UserOperations';\nimport MacroOperations from './module/MacroOperations';\nimport TokenHooks from './module/hooks/TokenHooks';\n\n/* eslint no-console: ['error', { allow: ['warn', 'log', 'debug'] }] */\n/* eslint-disable no-param-reassign */\n/* global CONFIG */\n\n/**\n * Our Collision instance.\n */\nlet collision;\n\n/**\n * Our TokenAnimationWatcher instance.\n */\nlet tokenAnimationWatcher;\n\n/**\n * Our TriggeringHandler instance.\n */\nlet triggeringHandler;\n\n/**\n * Our PostTriggerActions instance.\n */\nlet postTriggerActions;\n\n/**\n * Our TileAuditor instance.\n */\nlet tileAuditor;\n\n/**\n * Our SocketController instance.\n */\nlet socketController;\n\n/**\n * Our UserOperations instance.\n */\nlet userOperations;\n\n/**\n * Our MacroOperations instance.\n */\nlet macroOperations;\n\n/**\n * Our GameChanger instance.\n */\nlet gameChanger;\n\n/**\n * Our TokenUpdateCoordinator instance.\n */\nlet tokenUpdateCoordinator;\n\n/**\n * Our TokenCalculator instance.\n */\nlet tokenCalculator;\n\n/**\n * Our ReactionCoordinator instance.\n */\nlet reactionCoordinator;\n\n/**\n * Our EntityFinder instance.\n */\nlet entityFinder;\n\n/**\n * Our Animator instance.\n */\nlet animator;\n\n/**\n * Our TokenHooks instance.\n */\nlet tokenHooks;\n\n// Extract our early available dependencies out of the global scope.\nconst {\n  Hooks,\n  jQuery,\n  renderTemplate,\n} = global;\n\n/**\n * Determine if we're running Foundry v9.x or not.\n *\n * @return {boolean}\n */\nfunction isV9x() {\n  return CONFIG?.Canvas?.layers?.background?.layerClass != null;\n}\n\n/* ------------------------------------ */\n/* Initialize module                    */\n/* ------------------------------------ */\nHooks.once('init', () => {\n  console.log('hey-wait | Initializing hey-wait');\n  registerSettings();\n});\n\n/* ------------------------------------ */\n/* Setup module                         */\n/* ------------------------------------ */\nHooks.on('canvasReady', async () => {\n  const { canvas, game, ui } = global;\n\n  let backgroundLayer;\n  if (isV9x()) {\n    backgroundLayer = global.CONFIG.Canvas.layers.background.layerClass;\n  } else {\n    backgroundLayer = global.CONFIG.Canvas.layers.background;\n  }\n\n  collision = new Collision(canvas.grid.size);\n  gameChanger = new GameChanger(game, canvas);\n  entityFinder = new EntityFinder(game, canvas);\n\n  const layer = canvas.layers.find(\n    (targetLayer) => targetLayer instanceof backgroundLayer,\n  );\n\n  tokenCalculator = new TokenCalculator();\n  animator = new Animator(layer, ease);\n\n  reactionCoordinator = new ReactionCoordinator(\n    tokenCalculator,\n    animator,\n    game.settings,\n  );\n\n  macroOperations = new MacroOperations(\n    game.user,\n    canvas.background,\n    game.macros,\n    ui.notifications,\n  );\n  userOperations = new UserOperations(game.user, game.settings);\n\n  tokenAnimationWatcher = new TokenAnimationWatcher();\n\n  postTriggerActions = new PostTriggerActions(\n    gameChanger,\n    macroOperations,\n    reactionCoordinator,\n  );\n\n  triggeringHandler = new TriggeringHandler(\n    collision,\n    gameChanger,\n    tokenAnimationWatcher,\n  );\n\n  // Ensure that we only have a single socket open for our module so we don't\n  // clutter up open sockets when changing scenes (or, more specifically,\n  // rendering new canvases.)\n  if (socketController instanceof SocketController) {\n    await socketController.deactivate();\n  }\n  socketController = new SocketController(\n    game.socket,\n    game.user,\n    gameChanger,\n    entityFinder,\n    userOperations,\n    postTriggerActions,\n  );\n\n  tileAuditor = new TileAuditor();\n\n  tokenHooks = new TokenHooks(game.user, game.settings);\n\n  tokenUpdateCoordinator = new TokenUpdateCoordinator(\n    triggeringHandler,\n    postTriggerActions,\n    socketController,\n  );\n\n  await socketController.init();\n});\n\nHooks.on('preCreateTile', (document, data) => {\n  // This is referencing the data attached from the form submission, not a flag.\n  const isHeyWait = Boolean(data?.isHeyWaitTile);\n\n  if (!isHeyWait) {\n    return;\n  }\n\n  // Set the \"hey-wait\" flag on the new tile dataset.\n  data.flags = data.flags || {};\n\n  data.flags['hey-wait'] = {\n    enabled: true,\n    triggered: false,\n    animType: Number(data.heyWaitAnimType),\n    macro: data.heyWaitMacro,\n    // unlimited: data.heyWaitUnlimited,\n  };\n\n  // Hey, Wait! tiles should be hidden so players cannot see them.\n  data.hidden = true;\n\n  document.data.update(data);\n});\n\nHooks.on('preUpdateTile', (document, change, options) => {\n  const { data } = document;\n\n  if (!data?.flags?.['hey-wait']?.enabled) {\n    return;\n  }\n\n  // Ensure that Hey, Wait! tiles cannot be rotated.\n  // Currently, our logic for collision doesn't take into account rotations.\n  if (change?.rotation !== undefined) {\n    change.rotation = 0;\n  }\n\n  change.flags = change.flags || {};\n  change.flags['hey-wait'] = change.flags['hey-wait'] || {};\n\n  // Record the selected animation type for the Hey, Wait! tile.\n  if (change?.heyWaitAnimType !== undefined) {\n    change.flags['hey-wait'].animType = Number(change.heyWaitAnimType);\n    options.diff = true;\n  }\n\n  // Record the selected macro for the Hey, Wait! tile.\n  if (change?.heyWaitMacro !== undefined) {\n    change.flags['hey-wait'].macro = change.heyWaitMacro;\n    options.diff = true;\n  }\n\n  // Record the \"unlimited\" setting for the Hey, Wait! tile.\n  /* if (change?.heyWaitUnlimited !== undefined) {\n    change.flags['hey-wait'].unlimited = change.heyWaitUnlimited;\n    options.diff = true;\n  } */\n\n  // Change the tile image depending on triggered state.\n  const triggered = change.flags['hey-wait']?.triggered;\n  if (triggered !== undefined) {\n    change.img = triggered ? Constants.TILE_GO_PATH : Constants.TILE_STOP_PATH;\n    options.diff = true;\n  }\n\n  // Clean the document for any Hey, Wait! residue.\n  delete data.isHeyWaitTile;\n  delete data.heyWaitAnimType;\n  delete data.heyWaitMacro;\n  // delete data.heyWaitUnlimited;\n});\n\nHooks.on('preUpdateToken', async (document) => {\n  tokenUpdateCoordinator.registerTokenInitPos(\n    document.toObject(),\n  );\n});\n\nHooks.on('updateToken', async (document, change) => {\n  const canRunUpdate = tokenHooks.canRunTokenUpdate(\n    change,\n    document.data.disposition,\n    global.game.paused,\n  );\n\n  if (!canRunUpdate) {\n    return;\n  }\n\n  await tokenUpdateCoordinator.coordinateUpdate(\n    document,\n    global.canvas.background.tiles,\n  );\n});\n\nHooks.on('getSceneControlButtons', (controls) => {\n  const controlsGenerator = new ControlsGenerator();\n  controlsGenerator.generate(\n    controls,\n    global.game.user.isGM,\n  );\n});\n\nHooks.on('renderFormApplication', (config, html) => {\n  // Ensure the form application we're targeting is actually the Tile config.\n  // Ensure that we're also interacting with a Hey, Wait! tile, and not\n  // a regular tile.\n  if (!config?.options?.id) {\n    return;\n  }\n\n  const tileConfigOptionsId = isV9x()\n    ? global.CONFIG.Tile.sheetClasses.base['core.TileConfig'].cls.defaultOptions.id\n    : global.CONFIG.Tile.sheetClass.defaultOptions.id;\n\n  if (\n    config.options.id !== tileConfigOptionsId\n    || !tileAuditor.isHeyWaitTile(config.object, global.game.activeTool)\n  ) {\n    return;\n  }\n\n  const windowTitleEl = html.find('.window-title');\n  const originalTitle = windowTitleEl.html();\n  windowTitleEl.html(`Hey, Wait! ${originalTitle}`);\n\n  // Ensure we have the correct height for all the new Hey, Wait! elements.\n  html.height(384);\n});\n\nHooks.on('renderTileConfig', (config) => {\n  const { game } = global;\n\n  if (\n    !tileAuditor.isHeyWaitTile(config.object, game.activeTool)\n  ) {\n    return;\n  }\n\n  const selectedAnimType = config.object.data?.flags?.['hey-wait']?.animType\n    ?? Constants.DEFAULT_ANIM_TYPE;\n\n  const setMacro = config.object.data?.flags?.['hey-wait']?.macro;\n\n  /* const unlimitedChecked = Boolean(config.object.data?.flags?.['hey-wait']?.unlimited\n    ?? false); */\n\n  // Ensure the \"setMacro\" exists and wasn't deleted.\n  const selectedMacro = setMacro && game.macros.get(setMacro)\n    ? setMacro\n    : 0;\n\n  // Hide the file picker, rotation, and notes for Hey, Wait! tiling...\n  const $tileSpriteInputEl = jQuery(config.form).find(\n    'div[data-tab=\"basic\"] input[name=\"img\"]',\n  );\n\n  jQuery(config.form).find('.sheet-tabs a[data-tab!=\"basic\"]').hide();\n  jQuery(config.form).find('.sheet-tabs a[data-tab=\"basic\"]').html(\n    '<i class=\"fas fa-hand-paper\"></i> Hey, Wait!',\n  );\n\n  const $tileSpriteGroupEl = $tileSpriteInputEl.closest('.form-group');\n  const $rotationGroupEl = jQuery(config.form)\n    .find('input[name=\"rotation\"]')\n    .closest('.form-group');\n  const $tileSpriteNotesEl = $tileSpriteGroupEl.prev('.notes');\n  $tileSpriteGroupEl.hide();\n  $rotationGroupEl.hide();\n  $tileSpriteNotesEl.hide();\n\n  const $opacityGroupEl = jQuery(config.form)\n    .find('input[name=\"alpha\"]')\n    .closest('.form-group');\n  const $tintGroupEl = jQuery(config.form)\n    .find('input[name=\"tint\"]')\n    .closest('.form-group');\n  $opacityGroupEl.hide();\n  $tintGroupEl.hide();\n\n  if (!$tileSpriteInputEl.val()) {\n    $tileSpriteInputEl.val(Constants.TILE_STOP_PATH);\n  }\n\n  const $newNotes = jQuery('<p>')\n    .attr('class', 'notes');\n  $newNotes.html(\n    'Configure this Hey, Wait! tile. Hey, Wait! tiles that are <span style=\"color:darkred;font-weight:bold;\">red</span> have not been triggered yet. Hey, Wait! tiles that are <span style=\"color:green;font-weight:bold;\">green</span> have already been triggered by players.',\n  );\n\n  // Build \"Trigger Animation Type\" dropdown.\n  const tileType = jQuery('<select></select>')\n    .attr('name', 'heyWaitAnimType');\n  const tileTypeKeys = Object.values(Animator.animationTypes);\n  const tileTypeValues = [\n    game.i18n.localize('HEYWAIT.TILECONFIG.typeNone'),\n    game.i18n.localize('HEYWAIT.TILECONFIG.typeInfo'),\n    game.i18n.localize('HEYWAIT.TILECONFIG.typeQuestion'),\n    game.i18n.localize('HEYWAIT.TILECONFIG.typeExclamation'),\n  ];\n\n  for (let i = 0; i < tileTypeKeys.length; i += 1) {\n    const option = jQuery('<option></option>');\n    jQuery(option).val(tileTypeKeys[i]);\n    jQuery(option).html(tileTypeValues[i]);\n    jQuery(tileType).append(option);\n  }\n\n  tileType.val(selectedAnimType);\n\n  const tileTypeLabel = jQuery('<label></label>')\n    .attr('for', 'heyWaitAnimType')\n    .html(game.i18n.localize('HEYWAIT.TILECONFIG.typeText'));\n\n  const tileTypeWrapped = tileType\n    .wrap('<div class=\"form-group\"></div>')\n    .parent();\n\n  tileTypeWrapped.prepend(tileTypeLabel);\n\n  // Build \"Macro\" dropdown.\n  const $macro = jQuery('<select></select>')\n    .attr('name', 'heyWaitMacro');\n\n  // Add \"none\" at start.\n  const noneOption = jQuery('<option></option>');\n  jQuery(noneOption).val(0);\n  jQuery(noneOption).html(game.i18n.localize('HEYWAIT.TILECONFIG.macroNone'));\n  jQuery($macro).append(noneOption);\n\n  game.macros.forEach((macro) => {\n    const option = jQuery('<option></option>');\n    jQuery(option).val(macro.id);\n    jQuery(option).html(macro.data.name);\n    jQuery($macro).append(option);\n  });\n\n  $macro.val(selectedMacro);\n\n  const $macroLabel = jQuery('<label></label>')\n    .attr('for', 'heyWaitMacro')\n    .html(game.i18n.localize('HEYWAIT.TILECONFIG.macroText'));\n\n  const macroWrapped = $macro\n    .wrap('<div class=\"form-group\"></div>')\n    .parent();\n\n  macroWrapped.prepend($macroLabel);\n\n  // Build \"unlimited uses\" checkbox.\n  /* const $unlimited = jQuery('<input />', {\n    type: 'checkbox',\n    name: 'heyWaitUnlimited',\n    checked: unlimitedChecked,\n  });\n\n  const $unlimitedLabel = jQuery('<label></label>')\n    .attr('for', 'heyWaitUnlimited')\n    .html(game.i18n.localize('HEYWAIT.TILECONFIG.unlimitedText'));\n\n  const $unlimitedWrapped = $unlimited\n    .wrap('<div class=\"form-group\"></div>')\n    .parent();\n\n  const $unlimitedHint = jQuery('<p></p>')\n    .attr('class', 'notes')\n    .html(game.i18n.localize('HEYWAIT.TILECONFIG.unlimitedHint'));\n\n  $unlimitedWrapped.prepend($unlimitedLabel);\n  $unlimitedWrapped.append($unlimitedHint); */\n\n  jQuery(config.form).find('div[data-tab=\"basic\"]').first().append(\n    tileTypeWrapped,\n  );\n  jQuery(config.form).find('div[data-tab=\"basic\"]').first().append(\n    macroWrapped,\n  );\n  /* jQuery(config.form).find('div[data-tab=\"basic\"]').first().append(\n    $unlimitedWrapped,\n  ); */\n\n  // Add the hidden element specifying that this is a Hey, Wait! Tile.\n  const hidden = jQuery('<input>')\n    .attr('type', 'hidden')\n    .attr('name', 'isHeyWaitTile')\n    .attr('value', 1);\n\n  $newNotes.insertBefore($tileSpriteGroupEl);\n  jQuery(hidden).insertBefore(\n    jQuery(config.form).find(':submit'),\n  );\n});\n\nHooks.on('renderTileHUD', async (tileHud, html) => {\n  const tileDocument = tileHud.object.document;\n\n  if (!tileDocument.data?.flags?.['hey-wait']?.enabled) {\n    return;\n  }\n\n  // Hide the visibility icon as the Hey, Wait! tiles should always be hidden\n  // from players' view.\n  html.find('.control-icon[data-action=\"visibility\"]').hide();\n  html.find('.control-icon[data-action=\"overhead\"]').hide();\n  html.find('.control-icon[data-action=\"underfoot\"]').hide();\n\n  // Append Hey, Wait! template for the HUD. We need to specify `isNotTriggered`\n  // due to Handlebars not being able to inverse logic in a conditional.\n  const form = await renderTemplate(Constants.TEMPLATE_HUD_PATH, {\n    isNotTriggered: !tileDocument.data?.flags?.['hey-wait']?.triggered,\n  });\n  html.find('.col.right').prepend(form);\n\n  html.find('.hey-wait-isNotTriggered').click(async () => {\n    // Toggle the triggered state of the Hey, Wait! tile.\n    await tileDocument.setFlag(\n      'hey-wait',\n      'triggered',\n      !tileDocument.getFlag('hey-wait', 'triggered'),\n    );\n\n    tileHud.render();\n  });\n});\n"],"names":["Animator","constructor","layer","ease","animationTypes","TYPE_NONE","TYPE_INFO","TYPE_QUESTION","TYPE_EXCLAMATION","animate","type","x","y","gridSize","sprite","_getSprite","alpha","anchor","set","position","name","Math","random","toString","substring","child","addChild","anim1","add","duration","once","anim2","anim3","anim4","anim5","anim6","removeChild","fontSize","round","PIXI","Text","_getTextFromType","TextStyle","dropShadow","dropShadowDistance","fill","fontFamily","fontWeight","strokeThickness","Error","Collision","checkTileTokenCollision","tile","token","initTokenPos","tileX1","data","tileY1","tileX2","width","tileY2","height","tokenCanvasWidth","tokenCanvasHeight","tokenX1","tokenY1","tokenX2","tokenY2","tokenRay","Ray","Boolean","intersectSegment","Constants","MODULE_NAME","TOOLNAME","DISPOSITION_CHOICES","FRIENDLY","FRIENDLY_NETURAL","FRIENDLY_NEUTRAL_HOSTILE","DEFAULT_ANIM_TYPE","TEMPLATE_HUD_PATH","TILE_STOP_PATH","TILE_STOP_WIDTH","TILE_STOP_HEIGHT","TILE_GO_PATH","TILE_GO_WIDTH","TILE_GO_HEIGHT","TILE_FALLBACK_PATH","CANVAS_PAN_DURATION","ControlsGenerator","generate","controls","isGm","tileControl","find","control","browseControlIndex","tools","forEach","tool","index","console","error","splice","title","icon","EntityFinder","game","canvas","findScene","sceneId","scene","scenes","get","findTokenDocument","tokenId","tokens","tokenDocument","id","_id","findTile","tileId","filtered","background","tiles","filter","length","GameChanger","execute","location","_changeScene","user","isGM","_pause","_handleTileChange","pan","animatePan","scale","max","stage","document","update","flags","triggered","img","view","togglePause","MacroOperations","backgroundLayer","macros","notifications","handleTileMacroFiring","tokenDoc","bgTile","macroId","macro","actor","getActor","object","ReactionCoordinator","tokenCalculator","animator","settings","handleTokenReaction","animType","coords","calculateCoordinates","grid","_handleSfx","_sfxDisabled","path","AudioHelper","play","src","autoplay","volume","SocketController","socket","gameChanger","entityFinder","userOperations","postTriggerActions","socketName","init","_listen","deactivate","_removeListener","emit","pos","global","debug","on","canChangeGameForUser","e","message","off","TileAuditor","isHeyWaitTile","activeTool","enabled","TokenAnimationWatcher","watchForCompletion","timeout","ms","Promise","resolve","setTimeout","i","CanvasAnimation","animations","_getAnimationKeyFromTokenId","TokenCalculator","Number","TokenUpdateCoordinator","triggeringHandler","socketController","tokenInitPos","Map","registerTokenInitPos","coordinateUpdate","t0","performance","now","initPos","_cleanQueuedTokenInitPos","triggeredTile","handleTileTriggering","parent","t1","delete","UserOperations","viewedScene","warpPlayers","TokenHooks","canRunTokenUpdate","change","disposition","isPaused","_hasDataChanged","_isUserAllowed","_isDispositionAllowed","undefined","restrictGm","CONST","TOKEN_DISPOSITIONS","choices","dispositionsAllowed","NEUTRAL","includes","HOSTILE","dispositionChoices","i18n","localize","register","hint","scope","config","default","PostTriggerActions","macroOperations","reactionCoordinator","TriggeringHandler","collision","tokenAnimationWatcher","viewedSceneId","_isTileTriggered","_isHeyWaitTile","_checkIsValidWithOtherModules","_isPreviouslyTriggered","_levels","_levelsModuleName","isTokenInRange","registerSettings","tileAuditor","tokenUpdateCoordinator","tokenHooks","Hooks","jQuery","renderTemplate","isV9x","CONFIG","Canvas","layers","layerClass","log","ui","size","targetLayer","isHeyWait","heyWaitAnimType","heyWaitMacro","hidden","options","rotation","diff","toObject","canRunUpdate","paused","controlsGenerator","html","tileConfigOptionsId","Tile","sheetClasses","base","cls","defaultOptions","sheetClass","windowTitleEl","originalTitle","selectedAnimType","setMacro","selectedMacro","$tileSpriteInputEl","form","hide","$tileSpriteGroupEl","closest","$rotationGroupEl","$tileSpriteNotesEl","prev","$opacityGroupEl","$tintGroupEl","val","$newNotes","attr","tileType","tileTypeKeys","Object","values","tileTypeValues","option","append","tileTypeLabel","tileTypeWrapped","wrap","prepend","$macro","noneOption","$macroLabel","macroWrapped","first","insertBefore","tileHud","tileDocument","isNotTriggered","click","setFlag","getFlag","render"],"sourceRoot":""}